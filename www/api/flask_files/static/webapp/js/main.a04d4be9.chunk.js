(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{11:function(e,t,r){"use strict";r.d(t,"o",function(){return n}),r.d(t,"m",function(){return a}),r.d(t,"n",function(){return i}),r.d(t,"w",function(){return s}),r.d(t,"v",function(){return o}),r.d(t,"c",function(){return"APP_RELOAD"}),r.d(t,"d",function(){return"APP_SET_SYNC"}),r.d(t,"u",function(){return"UI_SET_DISPLAY_MAX_1_RESOURCE"}),r.d(t,"k",function(){return"ONTOLOGY_LIST"}),r.d(t,"l",function(){return"ONTOLOGY_REMOVE"}),r.d(t,"j",function(){return"ONTOLOGY_CREATE"}),r.d(t,"p",function(){return"SM_ADD_DATA_NODE"}),r.d(t,"q",function(){return"SM_ADD_EDGE"}),r.d(t,"s",function(){return"SM_REMOVE_NODE"}),r.d(t,"r",function(){return"SM_REMOVE_EDGE"}),r.d(t,"t",function(){return"SM_UPDATE_EDGE"}),r.d(t,"b",function(){return"ALIGNMENT_UPSERT"}),r.d(t,"a",function(){return"ALIGNMENT_REMOVE"}),r.d(t,"g",function(){return"DATASET_LIST"}),r.d(t,"h",function(){return"DATASET_REMOVE"}),r.d(t,"i",function(){return"DATASET_SELECT"}),r.d(t,"f",function(){return"DATASET_DESELECT"}),r.d(t,"e",function(){return"DATASET_CREATE"});var n="RESOURCE_UPSERT",a="RESOURCE_DELETE",i="RESOURCE_UPDATE_DATA",s="VARIABLE_UPSERT",o="VARIABLE_DELETE"},14:function(e,t,r){"use strict";var n={csv:"CSV format",json:"JSON format",netcdf4:"NetCDF4 format"},a=function(){return function(e,t){this.resourceId=e,this.resourceType=t}}(),i=r(83),s=r(2),o=r(9),l=function(){function e(e,t){this._shortURI=e,this._index=t}return e.deserialize4str=function(t){var r=t.lastIndexOf(":");return new e(t.substr(0,r),parseInt(t.substr(r+1),10))},Object.defineProperty(e.prototype,"shortURI",{get:function(){return this._shortURI},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return""+this._shortURI+this._index},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._shortURI+":"+this._index},enumerable:!0,configurable:!0}),e.prototype.serialize2str=function(){return this._shortURI+":"+this._index},e.prototype.getNamespacePrefix=function(){return this.shortURI.substr(0,this.shortURI.indexOf(":"))},e.prototype.next=function(){return new e(this._shortURI,this._index+1)},e}(),c=["xsd:string","xsd:int","xsd:decimal","xsd:dateTime","xsd:anyURI"],u=function(){function e(e,t,r,n,a){this.id=e,this.label=t,this.type=r,this.dataType=n,this.classId_=a}return e.classnode=function(t){return new e(t.id,t.shortURI,"classnode",void 0,t)},e.datanode=function(t,r){return new e(t,t,"datanode",r,void 0)},e.literalnode=function(t,r,n){return new e(t,r,"literalnode",n,void 0)},Object.defineProperty(e.prototype,"classId",{get:function(){return this.classId_},enumerable:!0,configurable:!0}),e.prototype.isClassNode=function(){return"classnode"===this.type},e.prototype.isDataNode=function(){return"datanode"===this.type},e}(),d=function(){return function(e,t,r,n){this.id=e,this.predicate=r,this.sourceId=t,this.targetId=n}}(),p=function(){function e(e,t,r,n,a,i){this.id2edge=t,this.id2node=e,this.lbl2nodes=r,this.type2nodes=n,this.incomingEdges=a,this.outgoingEdges=i}return e.default=function(){return new e({},{},{},{classnode:[],datanode:[]},{},{})},e.deserialize=function(t){var r,n,a=e.default();o.each(t.data_nodes,function(e,t){a.addNode(u.datanode(t,e.data_type)),a.hasNode(e.node_id)||a.addNode(u.classnode(l.deserialize4str(e.node_id))),a.addEdge(e.node_id,e.predicate,t)});try{for(var i=s.g(t.relations),c=i.next();!c.done;c=i.next()){var d=c.value;a.addEdge(d.source_id,d.predicate,d.target_id)}}catch(p){r={error:p}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(r)throw r.error}}return a},e.prototype.cloneRef=function(){return new e(this.id2node,this.id2edge,this.lbl2nodes,this.type2nodes,this.incomingEdges,this.outgoingEdges)},e.prototype.addNode=function(e){this.id2node[e.id]=e,this.incomingEdges[e.id]=new Set,this.outgoingEdges[e.id]=new Set,e.label in this.lbl2nodes||(this.lbl2nodes[e.label]=[]),e.isClassNode()?(this.lbl2nodes[e.label].splice(o.sortedIndexBy(this.lbl2nodes[e.label],e,function(e){return e.classId.index}),0,e),this.type2nodes.classnode.push(e)):(this.lbl2nodes[e.label].push(e),this.type2nodes.datanode.push(e))},e.prototype.hasNode=function(e){return e in this.id2node},e.prototype.addEdge=function(e,t,r){var n=e+"---"+t+"---"+r;if(!(e in this.id2node)||!(r in this.id2node))throw new Error("Cannot add an edge from un-existing node");if(n in this.id2edge)throw new Error("Cannot have same predicate between two nodes");this.id2edge[n]=new d(n,e,t,r),this.incomingEdges[r].add(n),this.outgoingEdges[e].add(n)},e.prototype.removeEdge=function(e){var t=this.id2edge[e];return this.outgoingEdges[t.sourceId].delete(e),this.incomingEdges[t.targetId].delete(e),delete this.id2edge[e],t},e.prototype.upwardCascadeRemoveEdge=function(e){var t=this.removeEdge(e);0===this.getNOutgoingEdges(t.sourceId)&&this.cascadeRemoveNode(t.sourceId)},e.prototype.cascadeRemoveNode=function(e){var t,r,n,a,i,o,l=this.id2node[e],c=[];try{for(var u=s.g(this.incomingEdges[e]),d=u.next();!d.done;d=u.next()){var p=d.value,h=this.removeEdge(p);this.id2node[h.sourceId].isClassNode()&&0===this.getNOutgoingEdges(h.sourceId)&&c.push(h.sourceId)}}catch(E){t={error:E}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(t)throw t.error}}if(l.isClassNode()){try{for(var f=s.g(this.outgoingEdges[e]),g=f.next();!g.done;g=f.next()){p=g.value,h=this.removeEdge(p);this.id2node[h.targetId].isClassNode()?0===this.getNOutgoingEdges(h.targetId)&&c.push(h.targetId):0===this.getNIncomingEdges(h.targetId)&&c.push(h.targetId)}}catch(w){n={error:w}}finally{try{g&&!g.done&&(a=f.return)&&a.call(f)}finally{if(n)throw n.error}}var m=this.type2nodes.classnode.indexOf(l);this.type2nodes.classnode.splice(m,1)}else{m=this.type2nodes.datanode.indexOf(l);this.type2nodes.datanode.splice(m,1)}delete this.id2node[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],this.lbl2nodes[l.label].splice(this.lbl2nodes[l.label].indexOf(l),1),0===this.lbl2nodes[l.label].length&&delete this.lbl2nodes[l.label];try{for(var v=s.g(c),y=v.next();!y.done;y=v.next()){var b=y.value;this.cascadeRemoveNode(b)}}catch(I){i={error:I}}finally{try{y&&!y.done&&(o=v.return)&&o.call(v)}finally{if(i)throw i.error}}},e.prototype.iterNodes=function(){var e,t,r,n;return s.d(this,function(a){switch(a.label){case 0:for(t in e=[],this.id2node)e.push(t);r=0,a.label=1;case 1:return r<e.length?(n=e[r],[4,this.id2node[n]]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})},e.prototype.iterDataNodes=function(){var e,t,r,n,a;return s.d(this,function(i){switch(i.label){case 0:i.trys.push([0,5,6,7]),r=s.g(this.type2nodes.datanode),n=r.next(),i.label=1;case 1:return n.done?[3,4]:[4,n.value];case 2:i.sent(),i.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return a=i.sent(),e={error:a},[3,7];case 6:try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}return[7];case 7:return[2]}})},e.prototype.iterClassNodes=function(){var e,t,r,n,a;return s.d(this,function(i){switch(i.label){case 0:i.trys.push([0,5,6,7]),r=s.g(this.type2nodes.classnode),n=r.next(),i.label=1;case 1:return n.done?[3,4]:[4,n.value];case 2:i.sent(),i.label=3;case 3:return n=r.next(),[3,1];case 4:return[3,7];case 5:return a=i.sent(),e={error:a},[3,7];case 6:try{n&&!n.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}return[7];case 7:return[2]}})},e.prototype.iterTriples=function(){var e,t,r,n,a;return s.d(this,function(i){switch(i.label){case 0:for(t in e=[],this.id2edge)e.push(t);r=0,i.label=1;case 1:return r<e.length?(n=e[r],a=this.id2edge[n],[4,[this.id2node[a.sourceId],a.predicate,this.id2node[a.targetId]]]):[3,4];case 2:i.sent(),i.label=3;case 3:return r++,[3,1];case 4:return[2]}})},e.prototype.iterEdges=function(){var e,t,r,n;return s.d(this,function(a){switch(a.label){case 0:for(t in e=[],this.id2edge)e.push(t);r=0,a.label=1;case 1:return r<e.length?(n=e[r],[4,this.id2edge[n]]):[3,4];case 2:a.sent(),a.label=3;case 3:return r++,[3,1];case 4:return[2]}})},e.prototype.iterIncomingEdges=function(e){var t,r,n,a,i,o;return s.d(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=s.g(this.incomingEdges[e]),a=n.next(),l.label=1;case 1:return a.done?[3,4]:(i=a.value,[4,this.id2edge[i]]);case 2:l.sent(),l.label=3;case 3:return a=n.next(),[3,1];case 4:return[3,7];case 5:return o=l.sent(),t={error:o},[3,7];case 6:try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},e.prototype.iterOutgoingEdges=function(e){var t,r,n,a,i,o;return s.d(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=s.g(this.outgoingEdges[e]),a=n.next(),l.label=1;case 1:return a.done?[3,4]:(i=a.value,[4,this.id2edge[i]]);case 2:l.sent(),l.label=3;case 3:return a=n.next(),[3,1];case 4:return[3,7];case 5:return o=l.sent(),t={error:o},[3,7];case 6:try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},e.prototype.getEdgeById=function(e){return this.id2edge[e]},e.prototype.getNodeById=function(e){return this.id2node[e]},e.prototype.getDataNodeSemanticType=function(e){if(this.hasNode(e)){var t=this.id2node[e];if(0!==this.incomingEdges[t.id].size){var r=this.id2edge[this.incomingEdges[t.id].values().next().value];return{ontClass:this.id2node[r.sourceId].classId,ontPredicate:r.predicate}}}},e.prototype.getNOutgoingEdges=function(e){return this.outgoingEdges[e].size},e.prototype.getNIncomingEdges=function(e){return this.incomingEdges[e].size},e.prototype.getClassNodesByShortURI=function(e){return this.lbl2nodes[e]||[]},e.prototype.getUsedNamespacePrefixes=function(){var e,t,r,n,a=new Set;try{for(var i=s.g(this.iterClassNodes()),o=i.next();!o.done;o=i.next()){var l=o.value;a.add(l.classId.getNamespacePrefix())}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}try{for(var c=s.g(this.iterEdges()),u=c.next();!u.done;u=c.next()){var d=u.value;-1!==d.predicate.indexOf(":")&&a.add(d.predicate.split(":",2)[0])}}catch(h){r={error:h}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}return a},e.prototype.serialize=function(e){var t,r,n={},a=[],i=[];try{for(var l=s.g(this.iterEdges()),c=l.next();!c.done;c=l.next()){var u=c.value,d=this.id2node[u.targetId];d.isClassNode()?a.push({source:u.sourceId,predicate:u.targetId,target:u.targetId}):d.isDataNode()?n[u.targetId]={node_id:u.sourceId,class_uri:this.id2node[u.sourceId].label,predicate:u.predicate,data_type:d.dataType}:i.push({node_id:u.sourceId,class_uri:this.id2node[u.sourceId].label,predicate:u.predicate,data:d.label,data_type:d.dataType})}}catch(h){t={error:h}}finally{try{c&&!c.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}var p=this.getUsedNamespacePrefixes();return{data_nodes:n,literal_nodes:i,relations:a,prefixes:o.fromPairs(o.map(s.f(p),function(t){return[t,e[t].namespace]}))}},e}(),h=function(){function e(e,t){this.source=e,this.target=t}return e.deserialize=function(e){return"dimension"===e.type?new g(e.source,e.target,o.map(e.aligned_dims,function(e){return{source:e.source,target:e.target}})):new f(e.source,e.target)},e}(),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return s.c(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return"value:"+this.source+"---"+this.target},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&null!==e&&(e.source===this.source&&e.target===this.target)},t.prototype.serialize=function(){return{type:"value",source:this.source,target:this.target}},t}(h),g=function(e){function t(t,r,n){var a=e.call(this,t,r)||this;return a.alignedDimensions=n,a}return s.c(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return"index:"+this.source+"---"+this.target+"---"+o.map(this.alignedDimensions,function(e){return e.source+"-"+e.target}).join(",")},enumerable:!0,configurable:!0}),t.prototype.addAlignedDimension=function(e,t){this.alignedDimensions.push({source:e,target:t})},t.prototype.isEqual=function(e){return e instanceof t&&null!==e&&(e.source===this.source&&e.target===this.target&&o.isEqual(this.alignedDimensions,e.alignedDimensions))},t.prototype.serialize=function(){return{type:"dimension",source:this.source,target:this.target,aligned_dims:o.map(this.alignedDimensions,function(e){return{source:e.source,target:e.target}})}},t}(h),m=(function(){function e(e,t,r,n,a){this.resources=e,this.variables=t,this.mappings=r,this.semanticModel=n,this.onts=a}e.prototype.serialize=function(){var e,t,r,n,a={};try{for(var i=s.g(this.resources),l=i.next();!l.done;l=i.next()){var c=l.value;a[c.resourceId]=c.resourceType}}catch(m){e={error:m}}finally{try{l&&!l.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}var u={};try{for(var d=s.g(this.variables),p=d.next();!p.done;p=d.next()){var h=p.value;u[h.id]={location:h.location.toString(!1)}}}catch(v){r={error:v}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}return{resources:a,transformation:[],layout:u,mappings:o.map(this.mappings,function(e){var t=e.serialize();if(e instanceof f)t.type="value_mapping";else{if(!(e instanceof g))throw new Error("Congrat! You found a bug");t.type="dimension_mapping"}return t}),semantic_model:this.semanticModel.serialize(this.onts)}}}(),function(){function e(e,t){this._prefix=e,this._ns=t}return Object.defineProperty(e.prototype,"prefix",{get:function(){return this._prefix},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"namespace",{get:function(){return this._ns},enumerable:!0,configurable:!0}),e}()),v=r(22);r.d(t,"l",function(){return n}),r.d(t,"j",function(){return a}),r.d(t,"k",function(){return i.d}),r.d(t,"i",function(){return i.c}),r.d(t,"e",function(){return i.a}),r.d(t,"f",function(){return i.b}),r.d(t,"o",function(){return i.e}),r.d(t,"c",function(){return c}),r.d(t,"g",function(){return u}),r.d(t,"m",function(){return p}),r.d(t,"h",function(){return m}),r.d(t,"c",function(){return c}),r.d(t,"g",function(){return u}),r.d(t,"m",function(){return p}),r.d(t,"b",function(){return l}),r.d(t,"a",function(){return h}),r.d(t,"n",function(){return f}),r.d(t,"d",function(){return g}),r.d(t,"p",function(){return v})},17:function(e,t,r){"use strict";var n=r(138);r.d(t,"a",function(){return n.withStyles})},18:function(e,t,r){"use strict";var n=r(49),a=r(11);function i(e,t){return void 0===t&&(t=null),{type:a.w,variable:e,previousVariableId:t}}function s(e){return{type:a.v,variableId:e}}var o=r(35),l=r.n(o),c=r(9),u=r(14),d=r(20),p=r(98),h=r(22);function f(){return function(e,t){return t().app.get("/datasets").then(function(t){var r=c.map(t.data.datasets,function(e){return{name:e.name,description:e.description,mbsize:null}});return e({type:a.g,datasets:r})})}}function g(e,t){return function(r,n){return n().app.post("/datasets",{name:e,description:t}).then(function(){return r({type:a.e,dataset:{name:e,description:t,mbsize:null}})})}}function m(e){return function(t,r){var n=r();return n.datasets.activeDataset===e&&t(v()),n.app.delete("/datasets/"+e).then(function(r){return t({type:a.h,datasetName:e})})}}function v(){return{type:a.f}}function y(e,t){return function(r,n){return n().app.get("/datasets/"+e,void 0,t).then(function(t){var n={},i=[],s=c.map(t.data.alignments,function(e){return u.a.deserialize(e)});for(var o in t.data.resources){var l=t.data.resources[o],f=h.Dimension.deserialize(l.dimension),g=f instanceof h.RangeDimension?new p.b([]):new p.c,m=new d.a(new u.j(o,l.type),new u.p.NDimData(o,f,g));n[o]=m}for(var v in t.data.variables){var y=t.data.variables[v];i.push(new u.o(y.id,y.sorted,y.value_type,y.unique,y.missing_values,u.f.fromSerializedSlices(y.location.resource_id,y.location.slices)))}r({type:a.i,datasetName:e,resources:c.values(n),variables:i,alignments:s,semanticModel:u.m.deserialize(t.data.semantic_model)})})}}function b(e){return{type:a.d,syncStatus:e}}function E(e){return function(t,r){return e.get("/ontologies").then(function(r){t({type:a.c,app:e}),t({type:a.k,ontologies:c.map(r.data.ontologies,function(e,t){return new u.h(t,e)})});var n=new URLSearchParams(window.location.search).get("dataset");if(null!==n)return t(y(n,!0)).catch(function(e){if(404!==e.response.status)throw e})})}}function w(e,t){return function(r,n){return l.a.post("/login",{email:e,password:t}).then(function(t){var a=n().app.cloneRef();return a.setAccessToken(e,t.data.auth_token),r(E(a))})}}var I=r(56);r(69);function S(e){return{type:a.b,mapping:e}}function x(e){return{type:a.a,mapping:e}}r.d(t,"k",function(){return n.a}),r.d(t,"r",function(){return i}),r.d(t,"q",function(){return s}),r.d(t,"d",function(){return E}),r.d(t,"e",function(){return b}),r.d(t,"c",function(){return w}),r.d(t,"l",function(){return I.a}),r.d(t,"m",function(){return I.b}),r.d(t,"n",function(){return I.c}),r.d(t,"p",function(){return I.e}),r.d(t,"o",function(){return I.d}),r.d(t,"b",function(){return S}),r.d(t,"a",function(){return x}),r.d(t,"h",function(){return f}),r.d(t,"f",function(){return g}),r.d(t,"i",function(){return m}),r.d(t,"j",function(){return y}),r.d(t,"g",function(){return v})},20:function(e,t,r){"use strict";var n,a=function(){function e(e){this.displayMax1Resource=e}return e.prototype.setDisplayMax1Resource=function(e){var t=this.shallowClone();return t.displayMax1Resource=e,t},e.prototype.clone=function(){return new e(this.displayMax1Resource)},e.prototype.shallowClone=function(){return new e(this.displayMax1Resource)},e}(),i=r(14),s=r(2),o=r(102),l=r(35),c=r.n(l),u=r(59),d=r(598);!function(e){e.synched="synched",e.synching="synching",e.error="error"}(n||(n={}));var p=function(){function e(e,t,r){this.synchStatus=e,this._email=t,this._accessToken=r}return e.default=function(){return new e(n.synched,"","")},e.prototype.cloneRef=function(){return new e(this.synchStatus,this._email,this._accessToken)},Object.defineProperty(e.prototype,"email",{get:function(){return this._email},enumerable:!0,configurable:!0}),e.prototype.isLoggedIn=function(){return""!==this._email},e.prototype.post=function(e,t,r,n){return r&&r.headers?r.headers.Authorization=this._accessToken:r=s.a({},r,{headers:{Authorization:this._accessToken}}),n?c.a.post(e,t,r):c.a.post(e,t,r).catch(function(e){throw d.a.error({message:"Error",description:e.response.data.message||e.message}),e})},e.prototype.get=function(e,t,r){return t&&t.headers?t.headers.Authorization=this._accessToken:t=s.a({},t,{headers:{Authorization:this._accessToken}}),r?c.a.get(e,t):c.a.get(e,t).catch(function(e){throw d.a.error({message:"Error",description:e.response.data.message||e.message}),e})},e.prototype.head=function(e,t,r){return t&&t.headers?t.headers.Authorization=this._accessToken:t=s.a({},t,{headers:{Authorization:this._accessToken}}),r?c.a.head(e,t):c.a.head(e,t).catch(function(e){throw d.a.error({message:"Error",description:e.response.data.message||e.message}),e})},e.prototype.delete=function(e,t,r){return t&&t.headers?t.headers.Authorization=this._accessToken:t=s.a({},t,{headers:{Authorization:this._accessToken}}),r?c.a.delete(e,t):c.a.delete(e,t).catch(function(e){throw d.a.error({message:"Error",description:e.response.data.message||e.message}),e})},e.prototype.attempt2ReLoggedIn=function(){var e=this,t=o.get("email"),r=o.get("accessToken");if(void 0===t||void 0===r)return Promise.resolve(this);var n=this.cloneRef();return n._email=t,n._accessToken=r,n.head("/has_authority",void 0,!0).then(function(){return n}).catch(function(){return e})},e.prototype.setAccessToken=function(e,t){if(!("string"===typeof t&&"string"===typeof e&&t.length>0&&e.length>0))throw new u.a("AccessToken or Email should not be null or undefined");this._accessToken=t,this._email=e,o.set("accessToken",t),o.set("email",e)},e}(),h=function(){return function(e,t){this.resource=e,this.data=t}}();r.d(t,"g",function(){return f}),r.d(t,"j",function(){return g}),r.d(t,"f",function(){return m}),r.d(t,"c",function(){return v}),r.d(t,"i",function(){return y}),r.d(t,"h",function(){return b}),r.d(t,"d",function(){return E}),r.d(t,"e",function(){return w}),r.d(t,"b",function(){return n}),r.d(t,"a",function(){return h});var f={},g={},m={},v=[],y=new a(!0),b=i.m.default(),E=p.default(),w={datasets:[],activeDataset:null}},22:function(e,t,r){"use strict";r.r(t);var n=function(){return function(e,t){this.indice=e,this.value=t}}(),a=r(98),i=r(2),s=r(9),o=function(){function e(e){void 0===e&&(e=0),this.counter=e}return e.prototype.next=function(){return this.counter++},e}(),l=function(){function e(e,t){this.id=e,this.depth=t}return e.deserialize=function(t,r,n){var a,s,l,d,p,h;if(void 0===r&&(r=0),void 0===n&&(n=new o),"range"===t.type){if(t.range.length!==t.values.length+1||0===t.values.length||t.range[0]<0)throw new Error("Invalid values of RangeDimension");var f=[];try{for(var g=i.g(t.range),m=g.next();!m.done;m=g.next()){if("inf"!==(w=m.value)){if(f.push(w),"number"!==typeof w)throw new Error("Invalid range values of RangeDimension")}else f.push(1/0)}}catch(D){a={error:D}}finally{try{m&&!m.done&&(s=g.return)&&s.call(g)}finally{if(a)throw a.error}}for(var v=1;v<f.length;v++)if(f[v]<f[v-1])throw new Error("Invalid range values of RangeDimension");var y=[];try{for(var b=i.g(t.values),E=b.next();!E.done;E=b.next()){var w;null===(w=E.value)?y.push(w):y.push(e.deserialize(w,r+1,n))}}catch(k){l={error:k}}finally{try{E&&!E.done&&(d=b.return)&&d.call(b)}finally{if(l)throw l.error}}return new c("rd_"+n.next(),r,f,y)}if("index"===t.type){var I={};try{for(var S=i.g(Object.keys(t.values)),x=S.next();!x.done;x=S.next()){var C=x.value;null===t.values[C]?I[C]=null:I[C]=e.deserialize(t.values[C],r+1,n)}}catch(R){p={error:R}}finally{try{x&&!x.done&&(h=S.return)&&h.call(S)}finally{if(p)throw p.error}}return new u("id_"+n.next(),r,I)}throw new Error("Invalid type of dimension. Expected range or index. Got "+t.type)},e}(),c=function(e){function t(t,r,n,a){var i=e.call(this,t,r)||this;return i.range=n,i.values=a,i}return i.c(t,e),t.prototype.get=function(e){return this.values[s.sortedLastIndex(this.range,e)-1]},t.prototype.getMaxNDims=function(){return Math.max.apply(Math,i.f(this.values.map(function(e){return null===e?0:e.getMaxNDims()})))+1},t.prototype.isValidSlice=function(e,t){if(void 0===t&&(t=!1),null===e)return!1;if(e instanceof m){if(e.start<this.range[0]||!t&&e.end!==1/0&&e.end>this.range[this.range.length-1])return!1;if(e.start===e.end&&this.range[this.range.length-1]===e.end)return!0;var r=s.sortedLastIndex(this.range,e.start)-1;do{if(!(null===this.values[r]&&null===e.values[r]||null!==this.values[r]&&this.values[r].isValidSlice(e.values[r],t)))return!1;r+=1}while(r<this.values.length&&this.range[r]<e.end);return!0}return!1},t.prototype.size=function(){if(this.range[this.range.length-1]!==1/0)return this.range[this.range.length-1]-this.range[0]},t.prototype.iterDFS=function(e){var t,r,n,a,s,o,l,c,u,d;return void 0===e&&(e=0),i.d(this,function(p){switch(p.label){case 0:return[4,[this,e]];case 1:p.sent(),n=0,p.label=2;case 2:if(!(n<this.range.length-1))return[3,11];if(null===(a=this.get(this.range[n])))return[3,10];p.label=3;case 3:p.trys.push([3,8,9,10]),s=i.g(a.iterDFS(e+1)),o=s.next(),p.label=4;case 4:return o.done?[3,7]:(l=i.e(o.value,2),c=l[0],u=l[1],[4,[c,u]]);case 5:p.sent(),p.label=6;case 6:return o=s.next(),[3,4];case 7:return[3,10];case 8:return d=p.sent(),t={error:d},[3,10];case 9:try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}return[7];case 10:return n++,[3,2];case 11:return[2]}})},t}(l),u=function(e){function t(t,r,n){var a=e.call(this,t,r)||this;return a.index2val=n,a}return i.c(t,e),t.prototype.get=function(e){return this.index2val[e]},t.prototype.getMaxNDims=function(){var e=this;return Math.max.apply(Math,i.f(Object.keys(this.index2val).map(function(t){return null===e.index2val[t]?0:e.index2val[t].getMaxNDims()})))+1},t.prototype.isValidSlice=function(e,t){var r,n;if(void 0===t&&(t=!1),null===e)return!1;if(e instanceof v){try{for(var a=i.g(Object.keys(e.index2slice)),s=a.next();!s.done;s=a.next()){var o=s.value;if(!(o in this.index2val))return!1;if(!(null===this.index2val[o]&&null===e.index2slice[o]||this.index2val[o].isValidSlice(e.index2slice[o],t)))return!1}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return!0}return!1},t.prototype.size=function(){return Object.keys(this.index2val).length},t.prototype.iterDFS=function(e){var t,r,n,a,s,o,l,c,u,d,p,h,f;return void 0===e&&(e=0),i.d(this,function(g){switch(g.label){case 0:return[4,[this,e]];case 1:for(a in g.sent(),n=[],this.index2val)n.push(a);s=0,g.label=2;case 2:if(!(s<n.length))return[3,11];if(o=n[s],null===(l=this.index2val[o]))return[3,10];g.label=3;case 3:g.trys.push([3,8,9,10]),c=i.g(l.iterDFS(e+1)),u=c.next(),g.label=4;case 4:return u.done?[3,7]:(d=i.e(u.value,2),p=d[0],h=d[1],[4,[p,h]]);case 5:g.sent(),g.label=6;case 6:return u=c.next(),[3,4];case 7:return[3,10];case 8:return f=g.sent(),t={error:f},[3,10];case 9:try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}return[7];case 10:return s++,[3,2];case 11:return[2]}})},t}(l),d=function(){return function(e,t,r){this.id=e,this.pod=r,this.dimension=t}}(),p=r(83),h=function(){function e(e){this.id=e}return e.deserialize=function(e){return function e(t,r){var n,a;if("range"===t.type)return new m("rds_"+r.next(),t.range,s.map(t.values,function(t){return null===t?null:e(t,r)}));var o="ids_"+r.next(),l={};try{for(var c=i.g(t.index2slice),u=c.next();!u.done;u=c.next()){var d=i.e(u.value,2),p=d[0],h=d[1];null!==t.index2slice[p]?l[p]=e(h,r):l[p]=null}}catch(f){n={error:f}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}return new v(o,l)}(e,new o)},e.fromSlices=function(e,t,r){var n=f(0,r,new o);return function(e,t,r,n,a){var l,c,u,d,p,h,f=new o,v={},b=0;try{for(var E=i.g(e.iterDim(t)),w=E.next();!w.done;w=E.next()){var I=i.e(w.value,2),S=I[0],x=I[1];x.depth in v||(v[x.depth]=[]),v[x.depth].push([S,x]),x.depth>b&&(b=x.depth)}}catch(_){l={error:_}}finally{try{w&&!w.done&&(c=E.return)&&c.call(E)}finally{if(l)throw l.error}}for(var C=b;C>=0;C--)try{for(var D=i.g(v[C]),k=D.next();!k.done;k=D.next()){var R=i.e(k.value,2),S=R[0],x=R[1];if(S instanceof m){if(S.end-S.start>n){var O=new y(S.range,S.values).changeRange(S.start,n);S.range=O.range,S.values=O.values}else if(S.end-S.start<n){var N=g(S.end,x,f,r,n,n),O=new y(S.range.concat(N.range.slice(1)),S.values.concat(N.values)).changeRange(S.start,n).optimize();S.range=O.range,S.values=O.values}}else{var V=s.size(S.index2slice);if(V>a){var T=Object.keys(S.index2slice).slice(0,a-V);try{for(var F=i.g(T),P=F.next();!P.done;P=F.next()){var j=P.value;delete S.index2slice[j]}}catch(U){p={error:U}}finally{try{P&&!P.done&&(h=F.return)&&h.call(F)}finally{if(p)throw p.error}}}else if(V<a){var M=a-V,A=void 0;for(var j in x.index2val)if(!(j in S.index2slice)&&(A=x.index2val[j],S.index2slice[j]=null===A?null:g(1/0,A,f,r,n,a),0===--M))break}}}}catch(z){u={error:z}}finally{try{k&&!k.done&&(d=D.return)&&d.call(D)}finally{if(u)throw u.error}}}(n,t,1e3,10,20),n},e.fromDimension=function(e,t){return g(t instanceof c?t.range[0]:1/0,t,new o,2e3,10,30)},e.prototype.isOverlappedWithSlices=function(e){var t,r;try{for(var n=i.g(this.iterDFS()),a=n.next();!a.done;a=n.next()){var s=i.e(a.value,2),o=s[0],l=e[s[1]];if(o instanceof m){if(l instanceof p.c){if(!l.isRangeOverlapped(o.start,o.end))return!1}else if(!(l.index>=o.start&&l.index<o.end))return!1}else if(l instanceof p.c){var c=!1;for(var u in o.index2slice)if("number"===typeof u&&l.isSelected(u)){c=!0;break}if(!c)return!1}else if(!(l.index in o.index2slice))return!1}}catch(d){t={error:d}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}return!0},e}();function f(e,t,r){var n;if(e>=t.length)return null;var a=t[e];if(a instanceof p.c){var i="rds_"+r.next(),s=[a.start,a.end],o=[f(e+1,t,r)];return new m(i,s,o)}return new v("ids_"+r.next(),((n={})[a.index]=f(e+1,t,r),n))}function g(e,t,r,n,a,i){if(t instanceof c){var o="rds_"+r.next(),l=new y(t.range,t.values),u=(l=l.changeRange(e,a)).range,d=s.map(l.values,function(e){return null===e?null:g(e instanceof c?e.range[0]:1/0,e,r,n,20,i)});return new m(o,u,d)}o="ids_"+r.next();var p={},h=void 0;for(var f in t.index2val){if(s.size(p)>i)break;h=t.index2val[f],p[f]=null===h?null:g(h instanceof c?h.range[0]:1/0,h,r,n,a,i)}return new v(o,p)}var m=function(e){function t(t,r,n){var a=e.call(this,t)||this;return a.range=r,a.values=n,a}return i.c(t,e),Object.defineProperty(t.prototype,"start",{get:function(){return this.range[0]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"end",{get:function(){return this.range[this.range.length-1]},enumerable:!0,configurable:!0}),t.prototype.isSelected=function(e){return this.start<=e&&e<this.end},t.prototype.setValue=function(e,t){this.values[s.sortedLastIndex(this.range,e)-1]=t},t.prototype.getValue=function(e){return this.values[s.sortedLastIndex(this.range,e)-1]},t.prototype.isSlicingAllIndices=function(e){if(e instanceof c)return this.start===e.range[0]&&this.end===e.range[e.range.length-1];throw new Error("Invalid type of dim, expected to be RangeDimension")},t.prototype.isSelectOne=function(){return this.end-this.start===1},t.prototype.toIndex=function(){if(this.isSelectOne())return this.start;throw new Error("Cannot convert the current slice into an index because it selects more than one element")},t.prototype.iter=function(e){var t,r;return i.d(this,function(n){switch(n.label){case 0:if(this.end!==1/0)return[3,4];t=this.start,n.label=1;case 1:return e.mayHas(t)?[4,e.get(t)]:[3,3];case 2:return n.sent(),t++,[3,1];case 3:return[3,8];case 4:r=this.start,n.label=5;case 5:return r<this.end?[4,e.get(r)]:[3,8];case 6:n.sent(),n.label=7;case 7:return r++,[3,5];case 8:return[2]}})},t.prototype.iterKeys=function(e){var t,r;return i.d(this,function(n){switch(n.label){case 0:if(this.end!==1/0)return[3,4];t=this.start,n.label=1;case 1:return e.mayHas(t)?[4,t]:[3,3];case 2:return n.sent(),t++,[3,1];case 3:return[3,8];case 4:r=this.start,n.label=5;case 5:return r<this.end?[4,r]:[3,8];case 6:n.sent(),n.label=7;case 7:return r++,[3,5];case 8:return[2]}})},t.prototype.iterEntries=function(e){var t,r;return i.d(this,function(n){switch(n.label){case 0:if(this.end!==1/0)return[3,4];t=this.start,n.label=1;case 1:return e.mayHas(t)?[4,[t,e.get(t)]]:[3,3];case 2:return n.sent(),t++,[3,1];case 3:return[3,8];case 4:r=this.start,n.label=5;case 5:return r<this.end?[4,[r,e.get(r)]]:[3,8];case 6:n.sent(),n.label=7;case 7:return r++,[3,5];case 8:return[2]}})},t.prototype.iterDFS=function(e){var t,r,n,a,s,o,l,c,u,d;return void 0===e&&(e=0),i.d(this,function(p){switch(p.label){case 0:return[4,[this,e]];case 1:p.sent(),n=0,p.label=2;case 2:if(!(n<this.range.length-1))return[3,11];if(null===(a=this.getValue(this.range[n])))return[3,10];p.label=3;case 3:p.trys.push([3,8,9,10]),s=i.g(a.iterDFS(e+1)),o=s.next(),p.label=4;case 4:return o.done?[3,7]:(l=i.e(o.value,2),c=l[0],u=l[1],[4,[c,u]]);case 5:p.sent(),p.label=6;case 6:return o=s.next(),[3,4];case 7:return[3,10];case 8:return d=p.sent(),t={error:d},[3,10];case 9:try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}return[7];case 10:return n++,[3,2];case 11:return[2]}})},t.prototype.iterDim=function(e){var t,r,n,a,s,o,l,c,u,d;return i.d(this,function(p){switch(p.label){case 0:return[4,[this,e]];case 1:p.sent(),n=0,p.label=2;case 2:if(!(n<this.range.length-1))return[3,11];if(null===(a=this.getValue(this.range[n])))return[3,10];p.label=3;case 3:p.trys.push([3,8,9,10]),s=i.g(a.iterDim(e.get(this.range[n]))),o=s.next(),p.label=4;case 4:return o.done?[3,7]:(l=i.e(o.value,2),c=l[0],u=l[1],[4,[c,u]]);case 5:p.sent(),p.label=6;case 6:return o=s.next(),[3,4];case 7:return[3,10];case 8:return d=p.sent(),t={error:d},[3,10];case 9:try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}return[7];case 10:return n++,[3,2];case 11:return[2]}})},t.prototype.serialize=function(){return{type:"range",range:this.range,values:s.map(this.values,function(e){return null===e?null:e.serialize()})}},t.prototype.clone=function(){return new t(this.id,this.range,s.map(this.values,function(e){return null===e?null:e.clone()}))},t}(h),v=function(e){function t(t,r){var n=e.call(this,t)||this;return n.index2slice=r,n}return i.c(t,e),t.prototype.isSelected=function(e){return e in this.index2slice},t.prototype.setValue=function(e,t){this.index2slice[e]=t},t.prototype.getValue=function(e){return this.index2slice[e]},t.prototype.isSlicingAllIndices=function(e){if(e instanceof u)return new Set(Object.keys(this.index2slice))===new Set(Object.keys(e.index2val));throw new Error("Invalid type of dim, expected to be RangeDimension")},t.prototype.isSelectOne=function(){return 1===Object.keys(this.index2slice).length},t.prototype.toIndex=function(){if(this.isSelectOne())return Object.keys(this.index2slice)[0];throw new Error("Cannot convert the current slice into an index because it selects more than one element")},t.prototype.iter=function(e){var t,r,n,a,s,o;return i.d(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=i.g(Object.keys(this.index2slice)),a=n.next(),l.label=1;case 1:return a.done?[3,4]:(s=a.value,[4,e[s]]);case 2:l.sent(),l.label=3;case 3:return a=n.next(),[3,1];case 4:return[3,7];case 5:return o=l.sent(),t={error:o},[3,7];case 6:try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},t.prototype.iterKeys=function(e){var t,r,n,a,s;return i.d(this,function(e){switch(e.label){case 0:e.trys.push([0,5,6,7]),n=i.g(Object.keys(this.index2slice)),a=n.next(),e.label=1;case 1:return a.done?[3,4]:[4,a.value];case 2:e.sent(),e.label=3;case 3:return a=n.next(),[3,1];case 4:return[3,7];case 5:return s=e.sent(),t={error:s},[3,7];case 6:try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},t.prototype.iterEntries=function(e){var t,r,n,a,s,o;return i.d(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=i.g(Object.keys(this.index2slice)),a=n.next(),l.label=1;case 1:return a.done?[3,4]:[4,[s=a.value,e[s]]];case 2:l.sent(),l.label=3;case 3:return a=n.next(),[3,1];case 4:return[3,7];case 5:return o=l.sent(),t={error:o},[3,7];case 6:try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}return[7];case 7:return[2]}})},t.prototype.iterDFS=function(e){var t,r,n,a,s,o,l,c,u,d,p,h,f;return void 0===e&&(e=0),i.d(this,function(g){switch(g.label){case 0:return[4,[this,e]];case 1:for(a in g.sent(),n=[],this.index2slice)n.push(a);s=0,g.label=2;case 2:if(!(s<n.length))return[3,11];if(o=n[s],null===(l=this.index2slice[o]))return[3,10];g.label=3;case 3:g.trys.push([3,8,9,10]),c=i.g(l.iterDFS(e+1)),u=c.next(),g.label=4;case 4:return u.done?[3,7]:(d=i.e(u.value,2),p=d[0],h=d[1],[4,[p,h]]);case 5:g.sent(),g.label=6;case 6:return u=c.next(),[3,4];case 7:return[3,10];case 8:return f=g.sent(),t={error:f},[3,10];case 9:try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}return[7];case 10:return s++,[3,2];case 11:return[2]}})},t.prototype.iterDim=function(e){var t,r,n,a,s,o,l,c,u,d,p,h,f;return i.d(this,function(g){switch(g.label){case 0:return[4,[this,e]];case 1:for(a in g.sent(),n=[],this.index2slice)n.push(a);s=0,g.label=2;case 2:if(!(s<n.length))return[3,11];if(o=n[s],null===(l=this.index2slice[o]))return[3,10];g.label=3;case 3:g.trys.push([3,8,9,10]),c=i.g(l.iterDim(e.get(o))),u=c.next(),g.label=4;case 4:return u.done?[3,7]:(d=i.e(u.value,2),p=d[0],h=d[1],[4,[p,h]]);case 5:g.sent(),g.label=6;case 6:return u=c.next(),[3,4];case 7:return[3,10];case 8:return f=g.sent(),t={error:f},[3,10];case 9:try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(t)throw t.error}return[7];case 10:return s++,[3,2];case 11:return[2]}})},t.prototype.serialize=function(){var e={type:"index",index2slice:[]};for(var t in this.index2slice)e.index2slice.push([isNaN(t)?t:parseInt(t,10),null!==this.index2slice[t]?this.index2slice[t].serialize():null]);return e},t.prototype.clone=function(){var e={};for(var r in this.index2slice)e[r]=null===this.index2slice[r]?null:this.index2slice[r].clone();return new t(this.id,e)},t}(h),y=function(){function e(e,t){this.range=e,this.values=t}return e.prototype.validate=function(){if(this.range.length!==this.values.length+1)return!1;for(var e=1;e<this.range.length;e++)if(this.range[e]<this.range[e-1])return!1;return!0},e.prototype.changeRange=function(t,r){if(t<this.range[0]||t>=this.range[this.range.length-1])throw new Error("Invalid start");r=Math.min(r,this.range[this.range.length-1]-t);for(var n=s.sortedLastIndex(this.range,t)-1,a=[t],i=[this.values[n]];++n<this.range.length;){if(this.range[n]-a[0]>=r){a.push(a[0]+r);break}a.push(this.range[n]),i.push(this.values[n])}return new e(a,i)},e.prototype.optimize=function(){for(var t=[this.range[0]],r=[],n=1;n<this.values.length;n++)s.isEqual(this.values[n-1],this.values[n])||(t.push(this.range[n]),r.push(this.values[n-1]));return t.push(this.range[this.range.length-1]),r.push(this.values[this.values.length-1]),new e(t,r)},e}(),b=function(){function e(e){var t,r;this.idmap={};try{for(var n=i.g(e.iterDFS()),a=n.next();!a.done;a=n.next()){var s=i.e(a.value,2),o=s[0];s[1];this.idmap[o.id]=o}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}return e.getWithoutIndex=function(e,t){var r,n;try{for(var a=i.g(e.iterDFS()),s=a.next();!s.done;s=a.next()){var o=i.e(s.value,2),l=o[0];o[1];if(l.id===t)return l}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new Error("Doesn't have any data slice with id "+t)},e.prototype.get=function(e){return this.idmap[e]},e}(),E=function(){function e(e){var t,r;this.idmap={};try{for(var n=i.g(e.iterDFS()),a=n.next();!a.done;a=n.next()){var s=i.e(a.value,2),o=s[0];s[1];this.idmap[o.id]=o}}catch(l){t={error:l}}finally{try{a&&!a.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}return e.getWithoutIndex=function(e,t){var r,n;try{for(var a=i.g(e.iterDFS()),s=a.next();!s.done;s=a.next()){var o=i.e(s.value,2),l=o[0];o[1];if(l.id===t)return l}}catch(c){r={error:c}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}throw new Error("Doesn't have any dimension with id "+t)},e.prototype.get=function(e){return this.idmap[e]},e}();r.d(t,"UnitOfData",function(){return n}),r.d(t,"PortionOfData",function(){return a.d}),r.d(t,"HashMapPortionOfData",function(){return a.c}),r.d(t,"ArrayPortionOfData",function(){return a.a}),r.d(t,"DiscontinuousArrayPortionOfData",function(){return a.b}),r.d(t,"Dimension",function(){return l}),r.d(t,"RangeDimension",function(){return c}),r.d(t,"IndexDimension",function(){return u}),r.d(t,"NDimData",function(){return d}),r.d(t,"DataSlice",function(){return h}),r.d(t,"slices2DataSlices",function(){return f}),r.d(t,"ContinuousRangeDataSlice",function(){return m}),r.d(t,"IndexDataSlice",function(){return v}),r.d(t,"RangeUtil",function(){return y}),r.d(t,"DataSliceIndex",function(){return b}),r.d(t,"DimensionIndex",function(){return E})},271:function(e,t,r){"use strict";(function(e){var n=r(2),a=r(188),i=r(10),s=r(595),o=r(596),l=r(594),c=r(593),u=r(125),d=r(9),p=r(0),h=r(24),f=r(14),g=r(18),m=r(17),v={labelCol:{span:4},wrapperCol:{span:20}},y={wrapperCol:{span:20,offset:4}},b="Must upload a resource or specify its URL",E={onClose:function(){}},w=function(t){function r(){var r=null!==t&&t.apply(this,arguments)||this;return r.state={resourceFiles:[],showExtra:!1},r.toggleShowExtraProperties=function(){(r.state.showExtra||r.props.form.getFieldValue("resourceType"))&&r.setState({showExtra:!r.state.showExtra})},r.onRemoveResourceFile=function(e){r.setState({resourceFiles:[]})},r.onSelectResourceFile=function(e){r.setState({resourceFiles:[e]});var t=r.props.form.getFieldError("resourceURL");return void 0!==t&&t.length>0&&-1!==t[0].toString().indexOf(b)&&r.props.form.setFields({resourceURL:{errors:void 0}}),!1},r.createNewResource=function(t){t.preventDefault(),r.props.form.validateFieldsAndScroll(function(t,n){if(!t)try{if(n.resourceId in r.props.resources)return void r.props.form.setFields({resourceId:{value:n.resourceId,errors:[new Error("Duplicated resource id")]}});if(0===r.state.resourceFiles.length&&(void 0===n.resourceURL||""===n.resourceURL.trim()))return void r.props.form.setFields({resourceURL:{value:void 0,errors:[new Error(b)]}});var a=void 0,i=void 0;switch(a=n.resourceFile?{isFile:!0,value:r.state.resourceFiles[0]}:{isFile:!1,value:n.resourceURL},n.resourceType.label){case f.l.csv:i={delimiter:r.normDelimiterChar(n.delimiter||",")};break;case f.l.json:case f.l.netcdf4:i={};break;default:throw new Error("Doesn't handle extra properties of "+n.resourceType.key+" yet")}r.props.dispatch(Object(g.k)(n.resourceId,n.resourceType.key,a,i)).then(function(){return r.props.onClose()}).catch(function(t){e.console.error("[ERROR]",t)})}catch(s){e.console.error("[BUG]",s)}})},r}return n.c(r,t),r.prototype.render=function(){var e,t=this,r=this.props.form.getFieldDecorator,h=d.map(f.l,function(e,t){return p.createElement(a.a.Option,{key:t,"data-testid":"antd-select-options","data-testvalue":t},e)});e=0===d.size(this.props.resources)?{initialValue:"default",rules:[{required:!1,whitespace:!0}]}:{rules:[{required:!0,whitespace:!0}]};var g=null,m=[];if(this.props.form.getFieldValue("resourceType")&&(g=p.createElement("a",{style:{marginLeft:8,fontSize:12},onClick:this.toggleShowExtraProperties},this.state.showExtra?"Collapse":"Show"," extra properties"," ",p.createElement(i.a,{type:this.state.showExtra?"up":"down"}))),this.state.showExtra)switch(this.props.form.getFieldValue("resourceType").label){case f.l.csv:m.push(p.createElement(s.a.Item,n.a({label:"Delimiter",key:"extra-delimiter"},v,{"data-testid":"upsert-resource-form-delimiter-wrapper"}),r("delimiter",{initialValue:",",rules:[{required:!1,whitespace:!0,validator:function(e,r,n){1!==t.normDelimiterChar(r).length&&n([new Error("Delimiter must be 1-character string")])}}]})(p.createElement(o.a,{"data-testid":"upsert-resource-form-delimiter"}))));break;case f.l.json:case f.l.netcdf4:break;default:throw new Error("Doesn't handle type "+this.props.form.getFieldValue("resourceType").key+" yet")}return p.createElement(l.a,{size:"small"},p.createElement("h2",null,"Create Resource"),p.createElement(s.a,{onSubmit:this.createNewResource,"data-testid":"upsert-resource-form"},p.createElement(s.a.Item,n.a({label:"Id"},v),r("resourceId",e)(p.createElement(o.a,{"data-testid":"upsert-resource-form-resource-id"}))),p.createElement(s.a.Item,n.a({label:"Type"},v),r("resourceType",{rules:[{required:!0,message:"Please select resource type"}]})(p.createElement(a.a,{showSearch:!0,labelInValue:!0,"data-testid":"upsert-resource-form-resource-type"},h))),p.createElement(s.a.Item,n.a({label:"Remote File"},v),r("resourceURL",{rules:[{whitespace:!0}]})(p.createElement(o.a,{"data-testid":"upsert-resource-form-resource-url"}))),p.createElement(s.a.Item,n.a({label:"Upload File"},v),r("resourceFile")(p.createElement(c.a,{onRemove:this.onRemoveResourceFile,beforeUpload:this.onSelectResourceFile,fileList:this.state.resourceFiles},p.createElement(u.a,null,p.createElement(i.a,{type:"upload"})," Upload file")))),m,p.createElement(s.a.Item,n.a({},y),p.createElement(u.a,{className:this.props.classes.marginRightButton,type:"danger"},"Clear"),p.createElement(u.a,{onClick:this.props.onClose,className:this.props.classes.marginRightButton},"Cancel"),p.createElement(u.a,{type:"primary",htmlType:"submit","data-testid":"upsert-resource-form-submit-button"},"Create"),g)))},r.prototype.normDelimiterChar=function(e){switch(e){case"\\t":return"\t";case"\\n":return"\n";default:return e}},r.defaultProps=E,r}(p.Component);t.a=s.a.create({})(Object(h.b)(function(e){return{resources:e.resources,app:e.app,datasets:e.datasets}})(Object(m.a)({marginRightButton:{marginRight:8},createResourceForm:{marginTop:8},uploadBtnContainer:{float:"right"},resourceInputContainer:{overflow:"hidden",paddingRight:8}})(w)))}).call(this,r(34))},290:function(e,t,r){e.exports=r(587)},295:function(e,t,r){},49:function(e,t,r){"use strict";r.d(t,"a",function(){return o}),r.d(t,"b",function(){return l}),r.d(t,"c",function(){return u});var n=r(11),a=r(20),i=r(22),s=r(14);function o(e,t,r,o){return function(l,c){var u=c(),d=new FormData;return d.set("resource_id",e),d.set("resource_type",t),r.isFile?d.set("resource_file",r.value):d.set("resource_url",r.value),d.set("extra",JSON.stringify(o)),u.app.post("/datasets/"+u.datasets.activeDataset+"/resources",d,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){var r=t.data.resource,o=i.Dimension.deserialize(r.dimension),c=o instanceof i.RangeDimension?new i.DiscontinuousArrayPortionOfData([]):new i.HashMapPortionOfData,u=new a.a(new s.j(r.id,r.type),new s.p.NDimData(r.id,o,c));return l({type:n.o,resourceID:e,resource:u})})}}function l(e){return function(t,r){var a=r();return a.app.delete("/datasets/"+a.datasets.activeDataset+"/resources/"+e).then(function(r){t({type:n.m,resourceId:e})})}}function c(e,t){return{type:n.n,resourceID:e,pod:t}}function u(e,t){return function(r,n){var a=n();return a.app.get("/datasets/"+a.datasets.activeDataset+"/resources/"+e,{params:{slices:t.serialize()}}).then(function(a){var s,o=n().resources[e].data,l=i.DataSlice.deserialize(a.data.slice);return s=0===o.pod.portionSize()?c(e,i.PortionOfData.fromSlices(t,o.dimension,a.data.data)):c(e,o.pod.addData(t,o.dimension,a.data.data)),r(s),l})}}},56:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return i}),r.d(t,"d",function(){return s}),r.d(t,"c",function(){return o}),r.d(t,"e",function(){return l});var n=r(11);function a(e){if(e.isClassNode())throw new Error("Cannot add ClassNode using AddDataNode function");return{type:n.p,dnode:e}}function i(e,t,r){return{type:n.q,sourceId:e,targetId:r,predicate:t}}function s(e){return{type:n.s,nodeId:e}}function o(e){return{type:n.r,edgeId:e}}function l(e,t,r,a){return{type:n.t,edgeId:e,sourceId:t,targetId:a,predicate:r}}},585:function(e,t,r){},587:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(13),i=r(2),s=(r(295),r(297),r(17)),o=r(271),l=r(24),c=r(125),u=r(192),d=r(193),p=r(594),h=r(588),f=r(22),g=r(10),m={status:"default"},v={top:"tborderBtn",right:"rborderBtn",bottom:"bborderBtn",left:"lborderBtn"},y={right:"rcornerBtn",left:"lcornerBtn"},b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onBorderClick=function(e){var r=i.e(t.getDimSliceIdxAndIndex(e),2),n=r[0],a=r[1];return function(e){e.stopPropagation();var r=t.props.value.indice.slice();r[n]=a,t.props.onCellClick(r)}},t.onCornerClick=function(e,r){var n=i.e(t.getDimSliceIdxAndIndex(e),2),a=n[0],s=n[1],o=i.e(t.getDimSliceIdxAndIndex(r),2),l=o[0],c=o[1];return function(e){e.stopPropagation();var r=t.props.value.indice.slice();r[a]=s,r[l]=c,t.props.onCellClick(r)}},t.onClick=function(){t.props.onCellClick(t.props.value.indice)},t}return i.c(t,e),t.prototype.render=function(){var e=[];if(this.props.enableSelection&&this.props.vp.isInBorder())if((this.props.vp.isInRightBorder()?1:0)+(this.props.vp.isInLeftBorder()?1:0)+(this.props.vp.isInTopBorder()?1:0)+(this.props.vp.isInBottomBorder()?1:0)>1){var t=this.props.vp.isInRightBorder()?"right":"left";e.push(n.createElement("div",{className:this.props.classes[v[t]],key:t,onClick:this.onBorderClick(t)},n.createElement(g.a,{type:"double-right"})));var r=this.props.vp.isInBottomBorder()?"bottom":"top";e.push(n.createElement("div",{key:r,className:this.props.classes[y[t]]+" "+this.props.classes[v[r]]},n.createElement("b",{className:this.props.classes.cornerBtn,onClick:this.onCornerClick(r,t)},"\u233e"),n.createElement("div",{onClick:this.onBorderClick(r)},n.createElement(g.a,{type:"double-right"}))))}else{var a=this.props.vp.isInRightBorder()?"right":this.props.vp.isInLeftBorder()?"left":this.props.vp.isInTopBorder()?"top":"bottom";"top"===a||"bottom"===a?e.push(n.createElement("div",{className:this.props.classes[v[a]],key:a},n.createElement("div",{onClick:this.onBorderClick(a)},n.createElement(g.a,{type:"double-right"})))):e.push(n.createElement("div",{className:this.props.classes[v[a]],key:a,onClick:this.onBorderClick(a)},n.createElement(g.a,{type:"double-right"})))}return n.createElement("td",{onClick:this.onClick,className:this.props.classes.root+" "+this.props.classes[this.props.status]+" "+this.props.className,style:this.props.style},this.props.children,e)},t.prototype.getDimSliceIdxAndIndex=function(e){switch(e){case"right":return[this.props.unboundedDim1SliceIdx,1/0];case"left":return[this.props.unboundedDim1SliceIdx,0];case"top":return[this.props.unboundedDim0SliceIdx,0];case"bottom":return[this.props.unboundedDim0SliceIdx,1/0]}},t.defaultProps=m,t}(n.Component),E=Object(s.a)({controlPanel:{float:"right"},root:{margin:-16,padding:16,position:"relative","& > div":{display:"none"},"&:hover":{"& > div":{display:"inherit"}}},default:{},disable:{},selected:{backgroundColor:"#4caf50 !important",border:"1px solid #45a248 !important",borderTop:"1px solid #45a248 !important",borderLeft:"1px solid #45a248 !important"},rborderBtn:{cursor:"pointer",position:"absolute",top:0,right:0,backgroundColor:"#ebebeb",height:"100%",paddingTop:16,paddingLeft:4,paddingRight:2,boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)"},lborderBtn:{cursor:"pointer",position:"absolute",top:0,left:0,backgroundColor:"#ebebeb",height:"100%",paddingTop:16,paddingLeft:2,paddingRight:4,boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)","& > i":{transform:"rotate(180deg)"}},tborderBtn:{position:"absolute",width:"100%",top:-25,left:0,paddingBottom:10,"& > div":{cursor:"pointer",textAlign:"center",backgroundColor:"#ebebeb",boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)","& > i":{transform:"rotate(-90deg)"}}},bborderBtn:{position:"absolute",width:"100%",bottom:-25,left:0,paddingTop:10,zIndex:3,"& > div":{cursor:"pointer",textAlign:"center",backgroundColor:"#ebebeb",boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)","& > i":{transform:"rotate(90deg)"}}},cornerBtn:{cursor:"pointer",width:20,backgroundColor:"#ebebeb",boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",display:"block",textAlign:"center"},rcornerBtn:{"& > div":{marginRight:23},"& > b":{float:"right"}},lcornerBtn:{"& > div":{marginLeft:23},"& > b":{float:"left"}}})(b),w=r(592),I=function(){function e(e,t){this.vpIndex=e,this.vpSize=t}return e.prototype.isInBorder=function(){return 0===this.vpIndex[0]||0===this.vpIndex[1]||this.vpIndex[0]===this.vpSize[0]-1||this.vpIndex[1]===this.vpSize[1]-1},e.prototype.isInRightBorder=function(){return this.vpIndex[1]===this.vpSize[1]-1},e.prototype.isInLeftBorder=function(){return 0===this.vpIndex[1]},e.prototype.isInTopBorder=function(){return 0===this.vpIndex[0]},e.prototype.isInBottomBorder=function(){return this.vpIndex[0]===this.vpSize[0]-1},e}(),S=r(14),x=r(9),C=function(){function e(e,t,r,n){this.data=e,this.dslice=t,this.unboundDims=r,this.selectedSlices=n,this.dataDimIndex=new f.DimensionIndex(e.dimension)}return e.fromData=function(t,r){var n,a,s=f.DataSlice.fromDimension(t,r.dimension),o=[],l=[];try{for(var c=i.g(s.iterDim(r.dimension)),u=c.next();!u.done;u=c.next()){var d=i.e(u.value,2),p=d[0],h=d[1];p instanceof f.ContinuousRangeDataSlice?(l.push({dsliceId:p.id,sliceIdx:o.length,dimId:h.id}),o.push(h instanceof f.RangeDimension?S.i.default():S.e.default())):o.push(new S.e(p.toIndex()))}}catch(g){n={error:g}}finally{try{u&&!u.done&&(a=c.return)&&a.call(c)}finally{if(n)throw n.error}}if(2!==l.length)throw Error("Can only create slices for 2D unbound dimensions");return new e(r,s,l,o)},e.prototype.getNRows=function(){var e,t,r=this.unboundDims[0].dsliceId,n=this.data.pod;try{for(var a=i.g(this.dslice.iterDim(this.data.dimension)),s=a.next();!s.done;s=a.next()){var o=i.e(s.value,2),l=o[0],c=o[1];if(l.id===r)return void 0===c.size()?n.hasAllUpperIndices?n.portionSize():void 0:c.size();n=n.get(l.toIndex())}}catch(u){e={error:u}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}throw new Error("Congrat! You found a bug in which we are trying to determine the number of rows. Please report it")},e.prototype.getRowsView=function(e,t){var r=this.dslice.clone(),n=f.DataSliceIndex.getWithoutIndex(r,this.unboundDims[0].dsliceId);if(!(n instanceof f.ContinuousRangeDataSlice))throw new Error("Doesn't know how to navigate pages in index page yet");if(2!==n.range.length)throw new Error("NotImplementedYet");return n.range=[e,t],r},e.prototype.iterUnboundDimensionValues=function(e){return f.DataSliceIndex.getWithoutIndex(this.dslice,this.unboundDims[e].dsliceId).iterKeys(this.data.pod)},e.prototype.removeSelectedSlices=function(){var t=x.map(this.selectedSlices,function(e){return e.clone()});return D(t,this.unboundDims),new e(this.data,this.dslice,this.unboundDims,t)},e.prototype.isSelected=function(e,t){if(this.isNoSelection())return!1;var r=this.selectedSlices[this.unboundDims[0].sliceIdx];if(r instanceof S.i){if(!r.isSelected(e))return!1}else if(r.index!==e)return!1;var n=this.selectedSlices[this.unboundDims[1].sliceIdx];if(n instanceof S.i){if(!n.isSelected(t))return!1}else if(n.index!==t)return!1;return!0},e.prototype.click=function(e){var t=x.map(this.selectedSlices,function(e){return e.clone()}),r=e[this.unboundDims[0].sliceIdx],n=e[this.unboundDims[1].sliceIdx],a=t[this.unboundDims[0].sliceIdx],i=t[this.unboundDims[1].sliceIdx];if(this.isNoSelection())return r===1/0||n===1/0?t:(a instanceof S.i?(a.start=r,a.end=a.start+1):a.index=r,i instanceof S.i?(i.start=n,i.end=i.start+1):i.index=n,t);if(this.isOneCellSelected()){var s=!0;return a instanceof S.i?(r<a.start?(a.end=a.start+1,a.start=r):a.end=r===1/0?1/0:r+1,a.isSelectOne()||(s=!1)):(r!==a.index&&(s=!1),this.dataDimIndex.get(this.unboundDims[0].dimId)instanceof f.RangeDimension?(a=new S.i(a.index,r+1,1),t[this.unboundDims[0].sliceIdx]=a):a.index=r),i instanceof S.i?(n<i.start?(i.end=i.start+1,i.start=n):i.end=n===1/0?1/0:n+1,i.isSelectOne()||(s=!1)):(n!==i.index&&(s=!1),this.dataDimIndex.get(this.unboundDims[1].dimId)instanceof f.RangeDimension?(i=new S.i(i.index,n+1,1),t[this.unboundDims[1].sliceIdx]=i):i.index=n),s&&D(t,this.unboundDims),t}return D(t,this.unboundDims),t},e.prototype.isNoSelection=function(){var e=this.selectedSlices[this.unboundDims[0].sliceIdx];return e instanceof S.e?e.index===S.k:e.start===S.k},e.prototype.isOneCellSelected=function(){return!this.isNoSelection()&&(this.selectedSlices[this.unboundDims[0].sliceIdx].isSelectOne()&&this.selectedSlices[this.unboundDims[1].sliceIdx].isSelectOne())},e}();function D(e,t){var r,n;try{for(var a=i.g(t),s=a.next();!s.done;s=a.next()){var o=e[s.value.sliceIdx];o instanceof S.i?(o.start=S.k,o.end=S.k):o.index=S.k}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}}var k={onUpdateSelectedSlices:function(e){},enableSelection:!1},R=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={rowsPerPage:10,page:0},t.onCellClick=function(e){var r=t.props.dataview.click(e);t.props.onUpdateSelectedSlices(new C(t.props.dataview.data,t.props.dataview.dslice,t.props.dataview.unboundDims,r))},t.handleChangePage=function(e,r){e-=1;var n=t.props.dataview.getRowsView(e*r,(e+1)*r);t.props.onUpdateDataSlices(n,new C(t.props.dataview.data,n,t.props.dataview.unboundDims,t.props.dataview.selectedSlices)).then(function(){t.setState({page:e,rowsPerPage:r})})},t.handleChangeRowsPerPage=function(e,r){var n=t.props.dataview.getRowsView(t.state.page*r,(t.state.page+1)*r);t.props.onUpdateDataSlices(n,new C(t.props.dataview.data,n,t.props.dataview.unboundDims,t.props.dataview.selectedSlices)).then(function(){t.setState({rowsPerPage:r})})},t}return i.c(t,e),t.prototype.render=function(){var e=i.e(this.getAntDTableByDataView(this.props.enableSelection,this.props.dataview),2),t=e[0],r=e[1],a=this.getAntDPagination(this.state.page,this.state.rowsPerPage);return n.createElement("div",{"data-testid":"data-matrix"},n.createElement(w.a,{className:this.props.classes.root,dataSource:t,columns:r,showHeader:!1,bordered:!0,rowKey:"id",pagination:a,components:{body:{cell:E}}}))},t.prototype.getAntDTableByDataView=function(e,t){var r,n,a,s,o,l,c,u,d=this,p=[],h=[],g=t.unboundDims[0].sliceIdx,m=t.unboundDims[1].sliceIdx,v=[];try{for(var y=i.g(t.dslice.iterDFS()),b=y.next();!b.done;b=y.next()){var E=i.e(b.value,2),w=E[0];E[1];w instanceof f.ContinuousRangeDataSlice?v.push(-1):v.push(w.toIndex())}}catch(A){r={error:A}}finally{try{b&&!b.done&&(n=y.return)&&n.call(y)}finally{if(r)throw r.error}}var S=Array.from(t.iterUnboundDimensionValues(1));try{for(var x=i.g(t.iterUnboundDimensionValues(0)),C=x.next();!C.done;C=x.next()){var D=C.value,k=[];try{for(var R=i.g(S),O=R.next();!O.done;O=R.next()){var N=O.value;v[g]=D,v[m]=N;var V=this.props.data.pod.getData(v),T="default";e&&t.isSelected(D,N)&&(T="selected"),k.push({cell:V,status:T})}}catch(_){o={error:_}}finally{try{O&&!O.done&&(l=R.return)&&l.call(R)}finally{if(o)throw o.error}}p.push({id:D,row:k})}}catch(U){a={error:U}}finally{try{C&&!C.done&&(s=x.return)&&s.call(x)}finally{if(a)throw a.error}}var F=0,P=[p.length,p[0].row.length];try{for(var j=i.g(S),M=j.next();!M.done;M=j.next()){N=M.value;h.push({dataIndex:"row."+F+".cell.value",onCell:function(t){return function(r,n){return{enableSelection:e,unboundedDim0SliceIdx:g,unboundedDim1SliceIdx:m,value:r.row[t].cell,status:r.row[t].status,onCellClick:d.onCellClick,vp:new I([n,t],P)}}}(F)}),F++}}catch(z){c={error:z}}finally{try{M&&!M.done&&(u=j.return)&&u.call(j)}finally{if(c)throw c.error}}return[p,h]},t.prototype.getAntDPagination=function(e,t){var r=this.props.dataview.getNRows();return{onChange:this.handleChangePage,onShowSizeChange:this.handleChangeRowsPerPage,total:r||1e6,showQuickJumper:!0,showSizeChanger:!0,current:e+1,pageSize:t,showTotal:this.getNPageString}},t.prototype.getNPageString=function(e){return void 0===e?"Unknown number of items":"Total "+e+" items"},t.defaultProps=k,t}(n.Component),O=Object(s.a)({root:{"& ul.ant-pagination.ant-table-pagination":{float:"left",marginLeft:8}}})(R),N=r(49),V=r(597),T=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDeleteResource=function(){V.a.confirm({title:"Are you sure you want to delete this resource?",okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){t.props.onDeleteResource(t.props.resource.resourceId)}})},t}return i.c(t,e),t.prototype.render=function(){return n.createElement(u.a,{className:this.props.classes.root,"data-testid":"resource-panel-header","data-testvalue":this.props.resource.resourceId},n.createElement(d.a,{span:20},this.props.resource.resourceId.toUpperCase()," (",this.props.resource.resourceType.toUpperCase(),")"),n.createElement(d.a,{span:4}))},t}(n.Component),F=Object(s.a)({root:{marginTop:-20,marginBottom:20,padding:"0 8px","& > .ant-col-20":{fontWeight:500},"& > div:last-child":{textAlign:"right"}}})(T),P={onUpdateSelectedSlices:function(e,t){},onHideResourcePanel:function(e){},onDeleteResource:function(e){}};function j(e,t){return 0===t.pod.portionSize()?null:C.fromData(e,t)}var M=function(e){function t(t){var r=e.call(this,t)||this;return r.waitForInit=function(){return i.b(r,void 0,void 0,function(){var e=this;return i.d(this,function(t){switch(t.label){case 0:return[4,(r=function(){return null!==e.state.dataview},n=1e4,a=50,i=Number(new Date)+n,s=function(e,t){r()?e(!0):Number(new Date)<i?setTimeout(s,a,e,t):t(new Error("timed out for "+r))},new Promise(s))];case 1:return t.sent(),[2]}var r,n,a,i,s})})},r.enableSelection=function(){return r.state.enableSelection?Promise.resolve():new Promise(function(e){r.setState({enableSelection:!0},e)})},r.disableSelection=function(){var e=r.state.dataview;return null!==e?new Promise(function(t,n){try{r.setState({enableSelection:!1,dataview:e.removeSelectedSlices()},t)}catch(a){n(a)}}):Promise.resolve()},r.setSelectedSlices=function(e){if(null===r.state.dataview||!r.state.enableSelection)return Promise.resolve();var t=r.state.dataview;return new Promise(function(n,a){try{if(t.dslice.isOverlappedWithSlices(e))r.setState({dataview:new C(t.data,t.dslice,t.unboundDims,e)},n);else{var i=f.DataSlice.fromSlices(r.props.resource.resource.resourceId,r.props.resource.data.dimension,e),s=t.unboundDims;r.props.dispatch(Object(N.c)(r.props.resource.resource.resourceId,i)).then(function(){r.setState({dataview:new C(r.props.resource.data,i,s,e)},n)}).catch(function(){a()})}}catch(o){a(o)}})},r.onUpdateDataSlices=function(e,t){return r.props.dispatch(Object(N.c)(r.props.resource.resource.resourceId,e)).then(function(e){r.setState({dataview:new C(t.data,e,t.unboundDims,t.selectedSlices)})})},r.onUpdateSelectedSlices=function(e){r.state.enableSelection&&r.state.dataview&&(r.setState({dataview:e}),r.props.onUpdateSelectedSlices(r.props.resource.resource.resourceId,e.selectedSlices))},r.state={dataview:j(t.resource.resource.resourceId,t.resource.data),enableSelection:!1},null===r.state.dataview&&r.props.dispatch(Object(N.c)(t.resource.resource.resourceId,f.DataSlice.fromDimension(t.resource.resource.resourceId,t.resource.data.dimension))),r}return i.c(t,e),t.getDerivedStateFromProps=function(e,t){return null===t.dataview?{dataview:j(e.resource.resource.resourceId,e.resource.data)}:null},t.prototype.render=function(){return null===this.state.dataview?n.createElement(p.a,{style:{textAlign:"center"}},n.createElement(g.a,{type:"loading",style:{fontSize:32}})):n.createElement(p.a,{className:this.props.classes.root,"data-testid":"resource-component","data-testvalue":this.props.resource.resource.resourceId,style:{overflowX:"scroll"}},n.createElement(F,{resource:this.props.resource.resource,onDeleteResource:this.props.onDeleteResource}),n.createElement(u.a,{className:this.props.classes.panelContent},n.createElement(O,{data:this.props.resource.data,dataview:this.state.dataview,enableSelection:this.state.enableSelection,onUpdateSelectedSlices:this.onUpdateSelectedSlices,onUpdateDataSlices:this.onUpdateDataSlices})))},t.defaultProps=P,t}(n.Component),A=Object(l.b)()(Object(s.a)({root:{"& > div.ant-card-body":{paddingLeft:0,paddingRight:0}},panelContent:{margin:"-1px"}})(M)),_=r(58),U=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={displayingResources:t.props.displayingResources||[]},t.resourceComponents={},t.postInit=Object(_.a)(function(e){return t.postInit_(e)}),t.waitForInit=function(e){return i.b(t,void 0,void 0,function(){return i.d(this,function(t){switch(t.label){case 0:return this.resourceComponents[e].current?[4,this.resourceComponents[e].current.waitForInit()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},t.enableSelection=function(e){return i.b(t,void 0,void 0,function(){return i.d(this,function(t){switch(t.label){case 0:return this.resourceComponents[e].current?[4,this.resourceComponents[e].current.enableSelection()]:[3,2];case 1:return[2,t.sent()];case 2:throw new Error("Cannot enable selection on a unmounted resource. This could happened when the displaying resources are controlled outside, and this function is called immediately after updating state")}})})},t.disableSelection=function(e){return i.b(t,void 0,void 0,function(){return i.d(this,function(t){switch(t.label){case 0:return this.resourceComponents[e].current?[4,this.resourceComponents[e].current.disableSelection()]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.setSelectedSlices=function(e,r){return i.b(t,void 0,void 0,function(){return i.d(this,function(t){switch(t.label){case 0:return this.resourceComponents[e].current?[4,this.resourceComponents[e].current.setSelectedSlices(r)]:[3,2];case 1:return[2,t.sent()];case 2:return[2]}})})},t.getOpenedResources=function(){return t.props.displayingResources?t.props.displayingResources:t.state.displayingResources},t.postInit_=function(e){var r,a,s=[];for(var o in t.resourceComponents)o in e||s.push(o);try{for(var l=i.g(s),c=l.next();!c.done;c=l.next()){o=c.value;delete t.resourceComponents[o]}}catch(u){r={error:u}}finally{try{c&&!c.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}for(var o in e)o in t.resourceComponents||(t.resourceComponents[o]=n.createRef())},t.onDeleteResource=function(e){t.props.dispatch(Object(N.b)(e))},t.onHideResourcePanel=function(e){return function(){var r;r=(void 0===t.props.displayMax1Resource?t.props.uiConf.displayMax1Resource:t.props.displayMax1Resource)?[e]:i.f(t.props.displayingResources||t.state.displayingResources,[e]),t.props.displayingResources?t.props.onDisplayingResourcesChange(r):t.setState({displayingResources:r})}},t}return i.c(t,e),t.prototype.render=function(){this.postInit(this.props.resources);var e=[],t=[],r=new Set(this.props.displayingResources||this.state.displayingResources);for(var a in this.props.resources){var i=this.props.resources[a],s=void 0;r.has(a)?(e.push(n.createElement(A,{innerRef:this.resourceComponents[a],key:a,resource:i,onHideResourcePanel:this.onHideResourcePanel(a),onUpdateSelectedSlices:this.props.onUpdateSelectedSlices,onDeleteResource:this.onDeleteResource})),s="primary"):s="default";var o=n.createElement(c.a,{key:a,onClick:this.onHideResourcePanel(a),type:s,"data-testid":"resource-panels-minimized-resources","data-testvalue":a},a);t.push(o)}return n.createElement(n.Fragment,null,n.createElement(p.a,{className:this.props.classes.hideResourcePanels},n.createElement("div",{className:"resource-list-header"},"Resources"),n.createElement(h.a,{type:"vertical"}),t),e)},t.defaultProps=i.a({},P,{displayMax1Resource:void 0,onDisplayingResourcesChange:function(e){}}),t}(n.Component);var z=Object(l.b)(function(e){return{resources:e.resources,uiConf:e.uiConf}})(Object(s.a)({hideResourcePanels:{"& > div":{padding:"8px !important"},"& button":{marginRight:8},"& .resource-list-header":{display:"inline-block",minWidth:80,fontWeight:600},"& .ant-divider":{height:"1.5em"},marginBottom:8}})(U)),L={},B=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={displayingCreateResourceForm:!1},t.displayCreateResourceForm=function(e){t.setState({displayingCreateResourceForm:!0})},t.hideCreateResourceForm=function(){t.setState({displayingCreateResourceForm:!1})},t}return i.c(t,e),t.prototype.render=function(){var e;return e=this.state.displayingCreateResourceForm?n.createElement(o.a,{onClose:this.hideCreateResourceForm}):n.createElement(c.a,{type:"primary",onClick:this.displayCreateResourceForm,"data-testid":"create-resource-button"},"Create resource"),n.createElement("div",{"data-testid":"resource-page"},n.createElement(u.a,{className:this.props.classes.createResourceForm},n.createElement(d.a,{span:24},e)),n.createElement(z,null))},t.defaultProps=L,t}(n.Component);var H=Object(l.b)(function(e){return{resources:e.resources}})(Object(s.a)({createResourceForm:{marginBottom:10}})(B)),q=r(18),W=r(20),G=r(595),Y=r(589),$=r(188),J=r(596),K=function(){function e(e,t,r){void 0===t&&(t="success"),void 0===r&&(r=""),this.value=e,this.validationStatus=t,this.validationMessage=r}return e.prototype.isValid=function(){return"success"===this.validationStatus},e}(),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={varId:new K(t.props.variable.id),type:t.props.variable.type,unique:t.props.variable.unique,sorted:t.props.variable.sorted,missingValues:t.props.variable.missingValues,isCollapsed:!0},t.delete=function(){t.props.onDelete(t.props.variable.id)},t.save=function(){if(t.props.layout.isValid()&&t.state.varId.isValid()){var e=t.props.resources[t.props.resourceId],r=S.f.fromString(e.resource.resourceId,t.props.layout.value),n=new S.o(t.state.varId.value,t.state.sorted,t.state.type,t.state.unique,t.state.missingValues,r);t.props.onSave(t.props.variable.id,n)}},t.toggleExpand=function(){t.setState({isCollapsed:!t.state.isCollapsed})},t.onSortedChange=function(e){t.setState({sorted:e})},t.onChangeResourceId=function(e){t.props.onChangeResourceId(e)},t.onVariableTypeChange=function(e){t.setState({type:e})},t.onUniqueChange=function(e){t.setState({unique:e})},t.onVariableIdChange=function(e){var r,n=e.target.value;r=""===n.trim()?new K(n,"error","Attribute id cannot be left blank"):n.trim()in t.props.variables?new K(n,"error","Duplicated attribute id"):new K(n),t.setState({varId:r})},t.onLayoutInputChange=function(e){t.props.onChangeLayout(e.target.value)},t}return i.c(t,e),t.prototype.render=function(){var e=this.props.isInsert?null:n.createElement(c.a,{type:"danger",className:"margin-left-8",onClick:this.delete,"data-testid":"upsert-variable-form-delete-btn"},"Delete"),t=null;return this.state.isCollapsed||(t=n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:2,offset:1},n.createElement(G.a.Item,{label:"Unique","data-testid":"upsert-variable-form-variable-unique"},n.createElement(Y.a,{checked:this.state.unique,onChange:this.onUniqueChange}))),n.createElement(d.a,{span:3},n.createElement(G.a.Item,{label:"Sorted"},n.createElement($.a,{value:this.state.sorted,onChange:this.onSortedChange,"data-testid":"upsert-variable-form-variable-sorted"},n.createElement($.a.Option,{"data-testid":"antd-select-options","data-testvalue":"null",value:"null"},"No Order"),n.createElement($.a.Option,{"data-testid":"antd-select-options","data-testvalue":"ascending",value:"ascending"},"Ascending"),n.createElement($.a.Option,{"data-testid":"antd-select-options","data-testvalue":"descending",value:"descending"},"Descending")))),n.createElement(d.a,{span:2},n.createElement(G.a.Item,{label:"Value Type"},n.createElement($.a,{value:this.state.type,onChange:this.onVariableTypeChange,"data-testid":"upsert-variable-form-variable-type"},["unspecified","int","float","string"].map(function(e){return n.createElement($.a.Option,{"data-testid":"ant-select-options","data-testvalue":e,value:e},x.capitalize(e))})))),n.createElement(d.a,{span:14},n.createElement(G.a.Item,{label:"Missing Values"},n.createElement($.a,{mode:"tags","data-testid":"upsert-variable-form-variable-missing-values"},x.map(this.state.missingValues,function(e){return n.createElement($.a.Option,{key:e,value:e,"data-testid":"antd-select-options","data-testvalue":e},e)})))))),n.createElement(p.a,{className:this.props.classes.root},n.createElement(G.a,null,n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:5},n.createElement(G.a.Item,{label:"Resource Id"},n.createElement($.a,{value:this.props.resourceId,onChange:this.onChangeResourceId,"data-testid":"upsert-variable-form-resource-id"},Object.keys(this.props.resources).map(function(e){return n.createElement($.a.Option,{key:e,value:e,"data-testid":"antd-select-options","data-testvalue":e},e)})))),n.createElement(d.a,{span:5},n.createElement(G.a.Item,{label:"Attribute Id",validateStatus:this.state.varId.validationStatus,help:this.state.varId.validationMessage},n.createElement(J.a,{value:this.state.varId.value,onChange:this.onVariableIdChange,"data-testid":"upsert-variable-form-variable-id"}))),n.createElement(d.a,{span:8},n.createElement(G.a.Item,{label:"Attribute Layout",validateStatus:this.props.layout.validationStatus,help:this.props.layout.validationMessage},n.createElement(J.a,{value:this.props.layout.value,onChange:this.onLayoutInputChange,"data-testid":"upsert-variable-form-variable-layout"}))),n.createElement(d.a,{span:6,style:{textAlign:"right"}},n.createElement(G.a.Item,{label:"\xa0",colon:!1},n.createElement(c.a,{onClick:this.props.onCancel,"data-testid":"upsert-variable-form-cancel-btn"},"Cancel"),e,n.createElement(c.a,{className:"margin-left-8",onClick:this.save,type:"primary","data-testid":"upsert-variable-form-submit-btn"},"Save"),n.createElement("a",{style:{marginLeft:8,fontSize:12},onClick:this.toggleExpand,"data-testid":"upsert-variable-form-collapse"},"Collapse"," ",n.createElement(g.a,{type:this.state.isCollapsed?"up":"down"}))))),t))},t}(n.Component),X=Object(s.a)({root:{"& > div":{padding:"8px !important"}}})(Q),Z={onVariableClick:function(e){},highlightVariableIds:new Set},ee=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onVariableClick=function(e){return function(){t.props.onVariableClick(e)}},t}return i.c(t,e),t.prototype.render=function(){var e,t,r=[];try{for(var a=i.g(this.props.variables),s=a.next();!s.done;s=a.next()){var o=s.value,l=o.id===this.props.selectedVariableId?"primary":this.props.highlightVariableIds.has(o.id)?"dashed":"default";r.push(n.createElement(c.a,{key:o.id,onClick:this.onVariableClick(o.id),type:l},o.id))}}catch(u){e={error:u}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n.createElement(p.a,{className:this.props.classes.root},n.createElement("div",{className:"variable-list-header"},"Attributes"),n.createElement(h.a,{type:"vertical"}),r)},t.defaultProps=Z,t}(n.Component),te=Object(s.a)({root:{"&>div":{padding:"8px !important"},"& > div > .variable-list-header":{minWidth:80,display:"inline-block",fontWeight:600},"& .ant-divider":{height:"1.5em"},"& button":{marginRight:8}}})(ee),re=function(e){function t(t){var r=e.call(this,t)||this;return r.state={upsertVariable:null,upsertVariableResourceId:void 0,upsertVariableLayout:void 0},r.onCreateVariable=function(){var e;if(r.resourcePanels.current){var t=r.resourcePanels.current.getOpenedResources(),n=t.length>0?t[0]:Object.keys(r.props.resources)[0],a=new S.f(n,[]);e=S.o.default("var_"+x.size(r.props.variables),a),r.setState({upsertVariable:e,upsertVariableLayout:r.validateUpsertVariableLayoutField(""),upsertVariableResourceId:[n]},function(){r.resourcePanels.current.enableSelection(n)})}},r.onUpdateVariable=function(e){if(e in r.props.variables){var t=r.props.variables[e];r.setState({upsertVariable:t,upsertVariableLayout:new K(t.location.toString(!0)),upsertVariableResourceId:[t.location.resourceId]},function(){r.resourcePanels.current.enableSelection(t.location.resourceId).then(function(){return r.resourcePanels.current.waitForInit(t.location.resourceId)}).then(function(){r.resourcePanels.current.setSelectedSlices(t.location.resourceId,t.location.slices)})})}},r.onDeleteVariable=function(e){var t=r.state.upsertVariable.location.resourceId;r.resourcePanels.current&&r.resourcePanels.current.disableSelection(t),r.props.dispatch(Object(q.q)(e)),r.setState({upsertVariable:null})},r.cancelUpsertVariableForm=function(){var e=r.state.upsertVariable.location.resourceId;r.resourcePanels.current&&r.resourcePanels.current.disableSelection(e),r.setState({upsertVariable:null,upsertVariableLayout:void 0,upsertVariableResourceId:void 0})},r.onSaveVariable=function(e,t){e in r.props.variables?r.props.dispatch(Object(q.r)(t,e)):r.props.dispatch(Object(q.r)(t)),r.resourcePanels.current&&r.resourcePanels.current.disableSelection(t.location.resourceId),r.setState({upsertVariable:null})},r.onDisplayingResourcesChange=function(e){if(null!==r.state.upsertVariable&&r.createVariableForm.current&&e.length>0){var t=e[0],n=r.validateUpsertVariableLayoutField("");r.setState({upsertVariable:r.state.upsertVariable.clone(),upsertVariableLayout:n,upsertVariableResourceId:[t]},function(){r.resourcePanels.current.enableSelection(t)})}},r.onUpdateSelectedSlices=function(e,t){if(r.state.upsertVariable&&r.createVariableForm.current&&e===r.state.upsertVariableResourceId[0]){var n=new K(new S.f(e,t).toString(!0));r.setState({upsertVariableLayout:n})}},r.onUpsertVariableChangeResourceId=function(e){r.setState({upsertVariableResourceId:[e]},function(){r.resourcePanels.current.enableSelection(e)})},r.onUpsertVariableChangeLayout=function(e){var t=r.validateUpsertVariableLayoutField(e);t.isValid()?r.setState({upsertVariableLayout:t},function(){r.syncLayout(r.state.upsertVariableResourceId[0],t.value)}):r.setState({upsertVariableLayout:t})},r.syncLayout=function(e,t){r.resourcePanels.current.enableSelection(e).then(function(){r.resourcePanels.current.setSelectedSlices(e,S.f.fromString(e,t).slices)})},r.validateUpsertVariableLayoutField=function(e){if(""===e.trim())return new K(e,"error","Layout cannot be left blank");var t=r.props.resources[r.state.upsertVariableResourceId[0]];try{if(!S.f.fromString(t.resource.resourceId,e).validate(t.data.dimension))return new K(e,"error","Invalid layout")}catch(n){return new K(e,"error","Invalid format")}return new K(e)},r.createVariableForm=n.createRef(),r.resourcePanels=n.createRef(),r.syncLayout=x.debounce(r.syncLayout,150),r}return i.c(t,e),t.prototype.render=function(){var e=this.state.upsertVariable?n.createElement(X,{key:this.state.upsertVariable.id,isInsert:!(this.state.upsertVariable.id in this.props.variables),onCancel:this.cancelUpsertVariableForm,onDelete:this.onDeleteVariable,onSave:this.onSaveVariable,innerRef:this.createVariableForm,variable:this.state.upsertVariable,variables:this.props.variables,resources:this.props.resources,resourceId:this.state.upsertVariableResourceId[0],layout:this.state.upsertVariableLayout,onChangeResourceId:this.onUpsertVariableChangeResourceId,onChangeLayout:this.onUpsertVariableChangeLayout}):null;return n.createElement("div",{className:this.props.classes.root,"data-testid":"layout-page"},n.createElement("div",{className:this.props.classes.controlUnit},n.createElement(c.a,null,"Add preprocessing"),n.createElement(c.a,{onClick:this.onCreateVariable,type:"primary","data-testid":"create-variable-button"},"Add attribute")),n.createElement(te,{variables:x.values(this.props.variables),selectedVariableId:this.state.upsertVariable?this.state.upsertVariable.id:void 0,onVariableClick:this.onUpdateVariable}),e,n.createElement(z,{innerRef:this.resourcePanels,displayMax1Resource:!0,displayingResources:this.state.upsertVariableResourceId,onDisplayingResourcesChange:this.onDisplayingResourcesChange,onUpdateSelectedSlices:this.onUpdateSelectedSlices}))},t}(n.Component);var ne=Object(l.b)(function(e){return{resources:e.resources,variables:e.variables}})(Object(s.a)({root:{"&>*":{marginBottom:10}},innerSpace7:{"&>*":{marginLeft:7},"&>*:first-child":{marginLeft:0}},controlUnit:{"&>*":{marginLeft:7},"&>*:first-child":{marginLeft:0}}})(re)),ae={style:{},formItemProps:{},forbiddenNodes:new Set,onChangeVariable:function(e){}},ie=function(e){function t(t){var r=e.call(this,t)||this;return r.validate=function(){if(void 0===r.state.field.validateStatus){var e=i.a({value:r.state.field.value},r.validateNotInForbiddenList(r.state.field.value));return r.setState({field:e}),"success"===e.validateStatus}return"success"===r.state.field.validateStatus},r.getValue=function(){return r.state.field},r.onChangeValue=function(e){r.setState({field:i.a({value:e},r.validateNotInForbiddenList(e))}),r.props.onChangeVariable(r.props.variables[e])},r.validateNotInForbiddenList=function(e){return void 0===e||r.props.forbiddenNodes.has(e)?{validateStatus:"error",errorMsg:"Cannot select nodes in forbidden list"}:{validateStatus:"success",errorMsg:void 0}},r.state={field:{value:t.value}},r}return i.c(t,e),t.prototype.render=function(){var e=[];for(var t in this.props.variables)e.push(n.createElement($.a.Option,{key:t},t));return n.createElement(G.a.Item,i.a({label:this.props.fieldName},this.props.formItemProps),n.createElement($.a,{value:this.state.field.value,showSearch:!0,style:this.props.style,onChange:this.onChangeValue},e))},t.defaultProps=ae,t}(n.Component),se=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.c(t,e),t.prototype.render=function(){return n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:9},n.createElement(ie,{key:this.props.var1id,variables:this.props.variables,fieldName:"",value:this.props.var1id,style:{width:"100%"},onChangeVariable:this.props.onSelectVar1})),n.createElement(d.a,{span:6,style:{textAlign:"center",paddingTop:3}},n.createElement($.a,{value:this.props.mappingType,onChange:this.props.onMappingTypeChange},n.createElement($.a.Option,{value:"index"},"Dimension"),n.createElement($.a.Option,{value:"value"},"Value"))),n.createElement(d.a,{span:9},n.createElement(ie,{key:this.props.var2id,variables:this.props.variables,fieldName:"",value:this.props.var2id,style:{width:"100%"},onChangeVariable:this.props.onSelectVar2})))},t}(n.Component),oe=["#F08080","#AF7AC5","#FFC300","#DAF7A6"],le=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={alignedDims:t.props.mapping?t.props.mapping.alignedDimensions:[],selectedDimensions:[void 0,void 0],dimensionElementCentroids:[[],[]]},t.componentDidMount=function(){t.setState({dimensionElementCentroids:[t.getDimensionElementCentroids(t.props.var1),t.getDimensionElementCentroids(t.props.var2)]})},t.componentDidUpdate=function(e,r){e.var1===t.props.var1&&e.var2===t.props.var2||t.setState({dimensionElementCentroids:[t.getDimensionElementCentroids(t.props.var1),t.getDimensionElementCentroids(t.props.var2)],selectedDimensions:[void 0,void 0],alignedDims:t.props.mapping?t.props.mapping.alignedDimensions:[]})},t.saveMapping=function(){var e,r,n=new S.d(t.props.var1.id,t.props.var2.id,[]);try{for(var a=i.g(t.state.alignedDims),s=a.next();!s.done;s=a.next()){var o=s.value;n.addAlignedDimension(o.source,o.target)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(e)throw e.error}}t.props.onSave(n)},t.undoLatestMappingAction=function(){t.setState({alignedDims:t.state.alignedDims.slice(0,t.state.alignedDims.length-2)})},t.getDimensionElementCentroids=function(e){var t,r,n={};if(void 0!==e){var a=document.getElementById("drepr-map-form").getBoundingClientRect();try{for(var s=i.g(document.getElementsByClassName("drepr-idx-map-"+e.id)),o=s.next();!o.done;o=s.next()){var l=o.value,c=l.getBoundingClientRect();n[l.dataset.dimensionelementindex]={top:(c.bottom-c.top)/2+c.top-a.top,left:(c.right-c.left)/2+c.left-a.left}}}catch(u){t={error:u}}finally{try{o&&!o.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}}return n},t.getVariableLocationElement=function(e){return void 0===e?null:n.createElement("div",{className:t.props.classes.variableLocation},e.location.slices.map(function(e,t){return n.createElement("span",{key:t,style:{backgroundColor:oe[t%oe.length]}},e.toString())}))},t.getDimensionElements=function(e,r,a){var i=[];if(void 0!==r){var s=t.props.resources[r.location.resourceId].resource.resourceType;i.push(r.location.slices.map(function(i,o){return i instanceof S.e?null:(l="csv"===s?1===o?"Column":"Row":"Dimension "+o,n.createElement(c.a,{key:o,type:o===a?"primary":"default",className:t.props.classes.dimensionElement+" drepr-idx-map-"+r.id,"data-dimensionelementindex":o,style:{backgroundColor:oe[o%oe.length]},onClick:t.selectVariableDimension(e,o)},l));var l}).filter(function(e){return null!==e}))}return i},t.selectVariableDimension=function(e,r){return function(){var n=1===e?0:1;void 0!==t.state.selectedDimensions[n]?(t.state.selectedDimensions[e]=r,t.state.alignedDims.push({source:t.state.selectedDimensions[0],target:t.state.selectedDimensions[1]}),t.setState({alignedDims:t.state.alignedDims,selectedDimensions:[void 0,void 0]})):(t.state.selectedDimensions[e]=r,t.setState({selectedDimensions:t.state.selectedDimensions.slice()}))}},t}return i.c(t,e),t.prototype.render=function(){var e,t,r=[];if(this.state.alignedDims.length>0&&x.size(this.state.dimensionElementCentroids[0])>0&&x.size(this.state.dimensionElementCentroids[1])>0)try{for(var a=i.g(this.state.alignedDims),s=a.next();!s.done;s=a.next()){var o=s.value;r.push(n.createElement("line",{key:o.source+"--"+o.target,x1:this.state.dimensionElementCentroids[0][o.source].left,y1:this.state.dimensionElementCentroids[0][o.source].top,x2:this.state.dimensionElementCentroids[1][o.target].left,y2:this.state.dimensionElementCentroids[1][o.target].top,stroke:"black"}))}}catch(l){e={error:l}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return n.createElement(n.Fragment,null,n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:8,offset:8,className:this.props.classes.controller},n.createElement(c.a,{shape:"circle",disabled:!this.props.var1||!this.props.var2,onClick:this.props.onClear},n.createElement(g.a,{type:"close-circle",theme:"filled"})),n.createElement(c.a,{shape:"circle",type:"danger",disabled:!this.props.var1||!this.props.var2,onClick:this.props.onDiscard},n.createElement(g.a,{type:"delete",theme:"filled"})),n.createElement(c.a,{shape:"circle",disabled:!(this.state.alignedDims.length>0),onClick:this.undoLatestMappingAction},n.createElement(g.a,{type:"undo"})),n.createElement(c.a,{shape:"circle",type:"primary",disabled:!this.props.var1||!this.props.var2,onClick:this.saveMapping},n.createElement(g.a,{type:"save",theme:"filled"})))),n.createElement(u.a,{gutter:8,className:this.props.classes.root,id:"drepr-map-form"},n.createElement(d.a,{span:9,className:"text-align-center"},this.getVariableLocationElement(this.props.var1),this.getDimensionElements(0,this.props.var1,this.state.selectedDimensions[0])),n.createElement(d.a,{span:9,offset:6,className:"text-align-center"},this.getVariableLocationElement(this.props.var2),this.getDimensionElements(1,this.props.var2,this.state.selectedDimensions[1])),n.createElement("svg",{className:this.props.classes.drawlingLine},r)))},t}(n.Component);var ce=Object(l.b)(function(e){return{resources:e.resources}})(Object(s.a)({controller:{marginTop:-20,textAlign:"center","& button":{paddingTop:2,marginRight:8},"& button:last-child":{marginRight:0}},dimensionElement:{display:"block",marginBottom:8,marginLeft:"auto",marginRight:"auto",zIndex:2},root:{zIndex:0},drawlingLine:{width:"100%",position:"absolute",left:0,top:0,zIndex:1},variableLocation:{margin:8,"& span":{padding:"5px 10px",fontSize:15}}})(le)),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.saveMapping=function(){var e=new S.n(t.props.var1.id,t.props.var2.id);t.props.onSave(e)},t}return i.c(t,e),t.prototype.render=function(){return n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:6,offset:9,className:this.props.classes.controller},n.createElement(c.a,{shape:"circle",disabled:!this.props.var1||!this.props.var2,onClick:this.props.onClear},n.createElement(g.a,{type:"close-circle",theme:"filled"})),n.createElement(c.a,{shape:"circle",type:"danger",disabled:!this.props.var1||!this.props.var2,onClick:this.props.onDiscard},n.createElement(g.a,{type:"delete",theme:"filled"})),n.createElement(c.a,{shape:"circle",type:"primary",disabled:!this.props.var1||!this.props.var2,onClick:this.saveMapping},n.createElement(g.a,{type:"save",theme:"filled"}))))},t}(n.Component),de=Object(s.a)({controller:{marginTop:-20,textAlign:"center","& button":{marginRight:8,paddingTop:2},"& button:last-child":{marginRight:0}}})(ue);var pe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={mapping:void 0,var1id:void 0,var2id:void 0,mappingType:"index"},t.hasVariable1=function(){return void 0!==t.state.var1id},t.hasVariable2=function(){return void 0!==t.state.var2id},t.setMapping=function(e){window.console.log("set mapping",e),t.setState({mapping:e,var1id:e.source,var2id:e.target,mappingType:e instanceof S.d?"index":"value"})},t.setVariable1=function(e){e.id!==t.state.var2id&&t.setState({var1id:e.id})},t.setVariable2=function(e){e.id!==t.state.var1id&&t.setState({var2id:e.id})},t.clearMapping=function(){t.setState({mapping:void 0,var1id:void 0,var2id:void 0,mappingType:"index"})},t.onClearMappingForm=function(){t.setState(i.a({},{mapping:void 0,var1id:void 0,var2id:void 0,mappingType:"index"},{mappingType:t.state.mappingType}))},t.onDiscardMappingForm=function(){t.state.mapping&&t.props.dispatch(Object(q.a)(t.state.mapping)),t.setState({mapping:void 0,var1id:void 0,var2id:void 0,mappingType:"index"})},t.onSaveMappingForm=function(e){return t.props.dispatch(Object(q.b)(e)),t.setState({mapping:void 0,var1id:void 0,var2id:void 0,mappingType:"index"}),new Promise(function(){})},t.changeMappingType=function(e){t.setState({mappingType:e})},t}return i.c(t,e),t.prototype.render=function(){var e=null;return e="index"===this.state.mappingType?n.createElement(ce,{key:this.state.mapping?this.state.mapping.id:void 0,mapping:this.state.mapping,var1:this.state.var1id?this.props.variables[this.state.var1id]:void 0,var2:this.state.var2id?this.props.variables[this.state.var2id]:void 0,onSave:this.onSaveMappingForm,onDiscard:this.onDiscardMappingForm,onClear:this.onClearMappingForm}):n.createElement(de,{key:this.state.mapping?this.state.mapping.id:void 0,mapping:this.state.mapping,var1:this.state.var1id?this.props.variables[this.state.var1id]:void 0,var2:this.state.var2id?this.props.variables[this.state.var2id]:void 0,onSave:this.onSaveMappingForm,onDiscard:this.onDiscardMappingForm,onClear:this.onClearMappingForm}),n.createElement(p.a,{size:"small"},n.createElement(se,{variables:this.props.variables,var1id:this.state.var1id,var2id:this.state.var2id,mappingType:this.state.mappingType,onMappingTypeChange:this.changeMappingType,onSelectVar1:this.setVariable1,onSelectVar2:this.setVariable2}),e)},t}(n.Component),he=Object(l.b)(null,null,null,{forwardRef:!0})(pe),fe=r(137),ge=r(285),me=r.n(ge),ve=r(286),ye=r.n(ve);fe.use(me.a),fe.use(ye.a);var be=[{selector:".eh-handle",style:{"background-color":"#db0d11",width:12,height:12,shape:"ellipse","overlay-opacity":0,"border-width":12,"border-opacity":0}},{selector:".eh-source",style:{"border-width":2,"border-color":"#db0d11"}},{selector:".eh-target",style:{"border-width":2,"border-color":"#db0d11"}},{selector:".eh-preview, .eh-ghost-edge",style:{width:2,"background-color":"#db0d11","line-color":"#db0d11","curve-style":"bezier","control-point-step-size":75,"target-arrow-color":"#db0d11","target-arrow-shape":"triangle"}}],Ee={onNodeClick:function(e){},onNodeRightClick:function(e){},onEdgeClick:function(e){},enableEdgeDrawingCreation:!1,canDrawEdgeBetweenNodes:function(e,t){return!0},onDrawNewEdgeComplete:function(e,t){}},we=function(e){function t(t){var r=e.call(this,t)||this;return r.cy=void 0,r.cyEdgeDrawing={isHoveringEh:!1,isHoveringNode:!1},r.syncWithCytoscape=Object(_.a)(function(e,t,n){return r.syncWithCytoscape_(e,t,n)}),r.onNodeClick=function(e){r.props.onNodeClick(e.target.id())},r.onNodeRightClick=function(e){r.props.onNodeRightClick(e.target.id())},r.onEdgeClick=function(e){r.props.onEdgeClick(e.target.id())},r.zoomIn=function(){void 0!==r.cy&&(r.cy.zoom(r.cy.zoom()+.5),r.cy.center())},r.zoomOut=function(){void 0!==r.cy&&(r.cy.zoom(r.cy.zoom()-.5),r.cy.center())},r.centerViewPort=function(){void 0!==r.cy&&r.cy.center()},r.container=n.createRef(),r}return i.c(t,e),t.prototype.componentDidMount=function(){var e=this;if(void 0===this.cy){this.cy=fe({container:this.container.current,layout:{name:"breadthfirst",fit:!0,spacingFactor:1,directed:!0},style:this.props.styles.concat(be)}),this.cyEdgeDrawing.eh=this.cy.edgehandles({preview:!1,hoverDelay:150,handleNodes:"node",snap:!1,snapThreshold:50,snapFrequency:15,noEdgeEventsInDraw:!0,disableBrowserGestures:!0,handleInDrawMode:!1,nodeLoopOffset:-50,edgeType:function(t,r){return e.props.canDrawEdgeBetweenNodes(t.id(),r.id())?"flat":null},edgeParams:function(e,t,r){return{data:{label:""}}},ghostEdgeParams:function(){return{data:{label:""}}},complete:function(t,r,n){e.props.onDrawNewEdgeComplete(t.id(),r.id()),n.remove()}}),window.eh=this.cyEdgeDrawing.eh;this.cy.on("mouseover",".eh-handle",function(){e.cyEdgeDrawing.isHoveringEh=!0}),this.cy.on("mouseover","node",x.debounce(function(){e.cyEdgeDrawing.isHoveringNode=!0},100)),this.cy.on("mouseout","node",x.debounce(function(){e.cyEdgeDrawing.isHoveringNode=!1,e.cyEdgeDrawing.isHoveringEh||e.cyEdgeDrawing.eh.hide()},50)),this.cy.on("mouseout",".eh-handle",x.debounce(function(){e.cyEdgeDrawing.isHoveringEh=!1,e.cyEdgeDrawing.isHoveringNode||e.cyEdgeDrawing.eh.hide()},150)),this.props.enableEdgeDrawingCreation?this.cyEdgeDrawing.eh.enable():this.cyEdgeDrawing.eh.disable(),this.syncWithCytoscape(this.props.nodes,this.props.edges,this.cy),this.cy.userZoomingEnabled(!1),this.cy.on("click","node",this.onNodeClick),this.cy.on("click","edge",this.onEdgeClick),this.cy.on("cxttap","node",this.onNodeRightClick)}},t.prototype.render=function(){this.syncWithCytoscape(this.props.nodes,this.props.edges,this.cy);var e=null,t="";return void 0!==this.props.title&&(e=n.createElement(h.a,{orientation:"left",className:this.props.classes.title},this.props.title),t=" "+this.props.classes.rootHasTitle),n.createElement(n.Fragment,null,e,n.createElement("div",{className:this.props.classes.root+t},n.createElement("div",{className:this.props.classes.floatedControlBtn},n.createElement(c.a,{onClick:this.zoomIn},"+"),n.createElement(c.a,{onClick:this.zoomOut},"-"),n.createElement(c.a,{onClick:this.centerViewPort},"\u233e")),n.createElement("div",{ref:this.container})))},t.prototype.syncWithCytoscape_=function(e,t,r){void 0!==r&&(r.remove(r.nodes()),r.remove(r.edges()),r.add(x.map(e,function(e){return{group:"nodes",data:e}})),r.add(x.map(t,function(e){return{group:"edges",data:e}})),r.layout(this.props.layout).run(),r.reset(),r.center())},t.defaultProps=Ee,t}(n.Component),Ie=Object(s.a)({root:{width:"100%",minHeight:"500px",border:"1px solid #e8e8e8",marginTop:8,"&>div:last-child":{width:"100%",minHeight:"500px"},position:"relative"},rootHasTitle:{borderTop:"none",marginTop:"-28px !important",paddingTop:16},title:{marginTop:"8px !important"},floatedControlBtn:{position:"absolute",top:5,right:0,zIndex:990,"& button":{marginRight:4,fontSize:"1.2em",lineHeight:"1.2em",padding:"0 10px 2px",fontWeight:500}}})(we),Se=r(59),xe=[{selector:"node",style:{label:"data(label)","text-halign":"center","text-valign":"center",width:"label",height:"label"}},{selector:'node[type="variable"]',style:{backgroundColor:"#FED530",shape:"rectangle",padding:"10px"}},{selector:"edge",style:{width:2,label:"data(label)","text-background-color":"#FFFFFF","text-background-opacity":1,"curve-style":"unbundled-bezier","line-color":"#A32B2E","target-arrow-color":"#A32B2E","target-arrow-shape":"none"}}],Ce={name:"spread",animate:!0,ready:void 0,stop:void 0,fit:!0,minDist:10,padding:10,expandingFactor:-1,prelayout:{name:"cose"},maxExpandIterations:4,boundingBox:void 0,randomize:!1};function De(e){if(-1!==e.source.indexOf(":::"))throw new Se.a("We assume that variable id doesn't have `:::` in it");return e.source+":::"+e.target}var ke=function(e){function t(t){var r=e.call(this,t)||this;return r.onGraphNodeClick=function(e){r.onVariableListClick(e)},r.onGraphEdgeClick=function(e){if(r.mappingForm.current){var t=function(e,t){var r,n,a=i.e(t.split(":::",2),2),s=a[0],o=a[1],l=null;try{for(var c=i.g(e),u=c.next();!u.done;u=c.next()){var d=u.value;if(d.source===s&&d.target===o){if(null!==l)throw new Se.a("More than one mapping between two variables");l=d}}}catch(p){r={error:p}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(r)throw r.error}}if(null===l)throw new Se.a("There is no mapping associated with an edge");return l}(r.props.mappings,e);r.mappingForm.current.setMapping(t)}},r.onVariableListClick=function(e){if(r.mappingForm.current){if(r.mappingForm.current.hasVariable1()&&r.mappingForm.current.hasVariable2())return void r.mappingForm.current.clearMapping();r.mappingForm.current.hasVariable1()?r.mappingForm.current.setVariable2(r.props.variables[e]):r.mappingForm.current.setVariable1(r.props.variables[e])}},r.mappingForm=n.createRef(),r}return i.c(t,e),t.prototype.render=function(){var e,t,r=x.map(this.props.variables,function(e){return{id:e.id,label:e.id,type:"variable"}}),a=[];try{for(var s=i.g(this.props.mappings),o=s.next();!o.done;o=s.next()){var l=o.value;a.push({id:De(l),source:l.source,target:l.target,label:l instanceof S.d?"dimension":"value"})}}catch(c){e={error:c}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(e)throw e.error}}return n.createElement(n.Fragment,null,n.createElement(te,{variables:x.values(this.props.variables),onVariableClick:this.onVariableListClick}),n.createElement("br",null),n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:12},n.createElement(he,{ref:this.mappingForm,variables:this.props.variables})),n.createElement(d.a,{span:12,style:{marginTop:-19}},n.createElement(Ie,{nodes:r,edges:a,title:"Mapping",styles:xe,layout:Ce,onNodeClick:this.onGraphNodeClick,onEdgeClick:this.onGraphEdgeClick}))))},t}(n.Component);var Re=Object(l.b)(function(e){return{variables:e.variables,mappings:e.alignments}})(Object(s.a)({})(ke)),Oe=r(598),Ne=r(590),Ve=r(196),Te=r(591),Fe=r(600),Pe=r(593),je=r(189),Me=r(90),Ae=r.n(Me),_e=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={},t.isSelectingDataset=!1,t.datasetColumns=[{title:"Name",dataIndex:"name"},{title:"Description",dataIndex:"description",width:500},{title:"Action",key:"action",render:function(e){return n.createElement(n.Fragment,null,n.createElement(c.a,{type:"primary",ghost:!0,onClick:t.toggleDatasetActivation(e.name)},e.isActive?"deactivate":"activate"),n.createElement(c.a,{type:"danger",ghost:!0,className:"margin-left-8",onClick:t.removeDataset(e.name)},"Delete"))}}],t.componentDidMount=function(){t.props.dispatch(Object(q.h)())},t.uploadRepr=function(e){var r=new FormData;return r.set("repr_file",e),t.props.app.post("/datasets/"+t.props.datasetTbl.activeDataset+"/repr",r).then(function(){return Oe.a.success({message:"upload success"}),t.props.dispatch(Object(q.j)(t.props.datasetTbl.activeDataset))}).catch(function(){Oe.a.error({message:"upload failed"})}),!1},t.downloadRepr=function(){t.props.app.get("/datasets/"+t.props.datasetTbl.activeDataset+"/repr").then(function(e){return new Blob([e.data])}).then(function(e){var r=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=r,n.download=t.props.datasetTbl.activeDataset+".model.yml",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(r)}).catch(function(){Oe.a.error({message:"Error while downloading a file"})})},t.downloadData=function(e){"ttl"===e.key?t.props.app.get("/datasets/"+t.props.datasetTbl.activeDataset+"/data").then(function(e){return new Blob([e.data])}).then(function(e){var r=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=r,n.download=t.props.datasetTbl.activeDataset+".ttl",document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(r)}).catch(function(){Oe.a.error({message:"Error while downloading a file"})}):Oe.a.error({message:"Not Implemented Yet"})},t.finishModeling=function(){var e=new URLSearchParams(window.location.search).get("on_finish");null!==e&&window.open(e,"_self")},t.createDataset=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll(function(e,r){if(!e)return t.props.dispatch(Object(q.f)(r.name,r.description)).then(function(){t.props.form.resetFields()})})},t.removeDataset=function(e){return function(){t.props.dispatch(Object(q.i)(e))}},t.toggleDatasetActivation=function(e){return function(){if(!t.isSelectingDataset){if(t.isSelectingDataset=!0,t.props.datasetTbl.activeDataset!==e)return t.props.dispatch(Object(q.j)(e)).then(function(){t.isSelectingDataset=!1});t.props.dispatch(Object(q.g)()),t.isSelectingDataset=!1}}},t}return i.c(t,e),t.prototype.render=function(){var e=this,t=this.props.form.getFieldDecorator;return n.createElement(n.Fragment,null,n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:24},null!==this.props.datasetTbl.activeDataset&&n.createElement(Fe.a,{type:"success",message:n.createElement("div",{style:{minHeight:35}},n.createElement("div",{style:{float:"right"}},n.createElement("div",{style:{display:"inline-block"}},n.createElement(Pe.a,{beforeUpload:this.uploadRepr,showUploadList:!1},n.createElement(c.a,null,n.createElement(g.a,{type:"upload"})," Upload D-Repr"))),n.createElement(c.a,{onClick:this.downloadRepr,className:"margin-left-8"},"Download D-Repr"),n.createElement(je.a,{overlay:n.createElement(Ve.b,{onClick:this.downloadData},n.createElement(Ve.b.Item,{key:"ttl"},"Turtle")),className:"margin-left-8"},n.createElement(c.a,null,"Download data as ",n.createElement(g.a,{type:"down"}))),n.createElement(c.a,{className:"margin-left-8",type:"primary",onClick:this.finishModeling},"Finish"),n.createElement(c.a,{className:"margin-left-8",type:"danger"},"Remove")),n.createElement("label",{style:{fontSize:16,fontWeight:600}},"Active dataset: ",this.props.datasetTbl.activeDataset))}))),n.createElement(u.a,{gutter:8,className:"margin-top-8"},n.createElement(d.a,{span:24},n.createElement(w.a,{columns:this.datasetColumns,dataSource:x.map(this.props.datasetTbl.datasets,function(t){return i.a({},t,{key:t.name,isActive:t.name===e.props.datasetTbl.activeDataset})}),bordered:!0}))),n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:24},n.createElement(Ae.a,{layout:"inline",onSubmit:this.createDataset},n.createElement(Ae.a.Item,{label:"Name"},t("name",{rules:[{required:!0,message:"Please provide a dataset name"}]})(n.createElement(J.a,{placeholder:"name"}))),n.createElement(Ae.a.Item,{label:"Description"},t("description")(n.createElement(J.a,{placeholder:"description"}))),n.createElement(Ae.a.Item,null,n.createElement(c.a,{type:"primary",htmlType:"submit"},"Create Dataset"))))))},t}(n.Component);var Ue=Ae.a.create({})(Object(l.b)(function(e){return{datasetTbl:e.datasets,app:e.app}})(Object(s.a)({})(_e))),ze=r(599),Le=r(69),Be=["magenta","red","volcano","orange","gold","green","cyan","blue","geekblue","purple"],He=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.ontTableColumns=[{title:"Prefix",dataIndex:"prefix",render:function(e,t){return n.createElement(ze.a,{color:t.color},e)}},{title:"URI",dataIndex:"uri"},{title:"Action",key:"action",render:function(e){return n.createElement("span",null,n.createElement("a",{href:"javascript:;",onClick:t.deleteOntology(e.prefix,e.uri)},"Delete"))}}],t.deleteOntology=function(e,r){return function(){t.props.dispatch(Object(Le.b)(e,r))}},t.createOntology=function(e){e.preventDefault(),t.props.form.validateFieldsAndScroll(function(e,r){if(!e)return t.props.dispatch(Object(Le.a)(r.file.file,r.prefix,r.namespace)).then(function(){t.props.form.resetFields()})})},t.stopUpload=function(){return!1},t}return i.c(t,e),t.prototype.render=function(){var e=[],t=this.props.form.getFieldDecorator;for(var r in this.props.ontologies)e.push({key:r,color:Be[e.length%Be.length],prefix:this.props.ontologies[r].prefix,uri:this.props.ontologies[r].namespace});return n.createElement(n.Fragment,null,n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:24},n.createElement(w.a,{columns:this.ontTableColumns,dataSource:e,bordered:!0}))),n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:24},n.createElement(G.a,{layout:"inline",onSubmit:this.createOntology},n.createElement(G.a.Item,{label:"Prefix"},t("prefix",{rules:[{required:!0,message:"Please provide a prefix"}]})(n.createElement(J.a,{placeholder:"prefix"}))),n.createElement(G.a.Item,{label:"Namespace"},t("namespace")(n.createElement(J.a,{placeholder:"namespace"}))),n.createElement(G.a.Item,{label:"Upload File"},t("file")(n.createElement(Pe.a,{beforeUpload:this.stopUpload},n.createElement(c.a,null,n.createElement(g.a,{type:"upload"})," Upload file")))),n.createElement(G.a.Item,null,n.createElement(c.a,{type:"primary",htmlType:"submit"},"Import Ontology"))))))},t}(n.Component);var qe=G.a.create({})(Object(l.b)(function(e){return{ontologies:e.ontologies,app:e.app}})(Object(s.a)({uploadBtnContainer:{},inputOntologyURIContainer:{overflow:"hidden",paddingRight:8}})(He))),We={},Ge={labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:18}}},Ye=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.c(t,e),t.prototype.render=function(){return n.createElement(G.a,null,n.createElement(G.a.Item,i.a({label:"Display maximum one resource"},Ge),n.createElement(Y.a,{checked:this.props.uiConf.displayMax1Resource})))},t.defaultProps=We,t}(n.Component);var $e=Object(l.b)(function(e){return{uiConf:e.uiConf}})(Object(s.a)({})(Ye)),Je={clazz:"full"},Ke=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={activeMenu:"datasets"},t.onChangeMenu=function(e){t.setState({activeMenu:e.key})},t}return i.c(t,e),t.prototype.render=function(){var e;switch(this.state.activeMenu){case"settings":e=n.createElement($e,null);break;case"datasets":e=n.createElement(Ue,null);break;case"ontology":e=n.createElement(qe,null)}return n.createElement(Ne.a,{style:{padding:"10px 0",background:"#fff",height:"100%"}},n.createElement(Ne.a.Sider,{width:200,style:{background:"#fff"}},n.createElement(Ve.b,{mode:"inline",onSelect:this.onChangeMenu,selectedKeys:[this.state.activeMenu],style:{height:"100%"}},n.createElement(Ve.b.Item,{key:"datasets"},n.createElement(g.a,{type:"database"}),"Datasets"),n.createElement(Ve.b.Item,{key:"ontology"},n.createElement(g.a,{type:"cluster"}),"Ontology"),n.createElement(Ve.b.Item,{key:"settings"},n.createElement(g.a,{type:"setting"}),"Settings"))),n.createElement(Ne.a.Content,{style:{padding:"0 10px"}},e))},t.defaultProps=Je,t}(n.Component),Qe=Object(s.a)({full:{}})(Ke),Xe=r(194),Ze=r(35),et=r.n(Ze),tt={style:{},formItemProps:{}},rt=function(e){function t(t){var r=e.call(this,t)||this;return r.validate=function(){if(void 0===r.state.field.validateStatus){var e=i.a({value:r.state.field.value},r.validateNotEmptyField(r.state.field.value));return r.setState({field:e}),"success"===e.validateStatus}return"success"===r.state.field.validateStatus},r.getValue=function(){return r.state.field.value},r.onSearch=function(e){r.setState({isSearching:!0}),r.props.search(e).then(function(e){r.setState({searchResults:e,isSearching:!1})})},r.onChangeValue=function(e){r.setState({field:i.a({value:e},r.validateNotEmptyField(e))})},r.validateNotEmptyField=function(e){return void 0!==e&&e.length>0?{validateStatus:"success",errorMsg:void 0}:{validateStatus:"error",errorMsg:"Cannot be empty"}},r.onSearch=x.debounce(r.onSearch,200),r.state={searchResults:[],isSearching:!1,field:{value:t.value}},r}return i.c(t,e),t.prototype.render=function(){var e=this.state.searchResults.map(function(e){return n.createElement($.a.Option,{key:e},e)});return n.createElement(G.a.Item,i.a({label:this.props.fieldName,validateStatus:this.state.field.validateStatus,help:this.state.field.errorMsg},this.props.formItemProps),n.createElement($.a,{showSearch:!0,value:this.state.field.value,defaultActiveFirstOption:!1,notFoundContent:this.state.isSearching?n.createElement("span",{style:{marginLeft:10,marginRight:10}},n.createElement(Xe.a,{size:"small"})):n.createElement("span",{style:{marginLeft:10,marginRight:10}},"Not Found.."),showArrow:!1,style:this.props.style,onSearch:this.onSearch,onChange:this.onChangeValue},e))},t.defaultProps=tt,t}(n.Component),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.c(t,e),t.defaultProps=i.a({search:function(e){return et.a.get("/ontologies/search",{params:{a:"class",q:e}}).then(function(e){return e.data.results})}},tt),t}(rt),at=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i.c(t,e),t.defaultProps=i.a({search:function(e){return et.a.get("/ontologies/search",{params:{a:"property",q:e}}).then(function(e){return e.data.results})}},tt),t}(rt),it=function(e){function t(t){var r=e.call(this,t)||this;return r.validate=function(){if(void 0===r.state.classId.validateStatus){var e=i.a({value:r.state.classId.value},r.validateClassIdField(r.state.classId.value));return r.setState({classId:e}),"success"===e.validateStatus}return"success"===r.state.classId.validateStatus},r.getValue=function(){return r.state.classId.value},r.onSearchOntClass=function(e){r.setState({searchingOntClasses:!0}),et.a.get("/ontologies/search",{params:{a:"class",q:e}}).then(function(e){var t,n,a,s,o=[];try{for(var l=i.g(e.data.results),c=l.next();!c.done;c=l.next()){var u=c.value,d=r.props.sm.getClassNodesByShortURI(u);if(d.length>0){try{for(var p=i.g(d),h=p.next();!h.done;h=p.next()){var f=h.value;o.push(f.classId)}}catch(g){a={error:g}}finally{try{h&&!h.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}o.push(d[d.length-1].classId.next())}else o.push(new S.b(u,1))}}catch(m){t={error:m}}finally{try{c&&!c.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}r.setState({searchOntClassResults:o,searchingOntClasses:!1})})},r.onChangeOntClassValue=function(e){var t=S.b.deserialize4str(e.key);r.setState({classId:i.a({value:t},r.validateClassIdField(t))})},r.validateClassIdField=function(e){return void 0!==e&&e instanceof S.b?{validateStatus:"success",errorMsg:void 0}:{validateStatus:"error",errorMsg:"Cannot be empty"}},r.onSearchOntClass=x.debounce(r.onSearchOntClass,200),r.state={searchOntClassResults:[],searchingOntClasses:!1,classId:{value:t.classId}},r}return i.c(t,e),t.prototype.render=function(){var e=this,t=this.state.searchOntClassResults.map(function(t,r){var a=r===e.state.searchOntClassResults.length-1;return r<e.state.searchOntClassResults.length-1&&e.state.searchOntClassResults[r+1].shortURI!==t.shortURI&&(a=!0),a?n.createElement($.a.Option,{key:t.serialize2str()},n.createElement("i",null,t.label)):n.createElement($.a.Option,{key:t.serialize2str()},t.label)});return n.createElement(G.a.Item,{label:"ClassId",validateStatus:this.state.classId.validateStatus,help:this.state.classId.errorMsg},n.createElement($.a,{labelInValue:!0,showSearch:!0,value:this.state.classId.value?{key:this.state.classId.value.serialize2str()}:void 0,defaultActiveFirstOption:!1,notFoundContent:this.state.searchingOntClasses?n.createElement("span",{style:{marginLeft:10,marginRight:10}},n.createElement(Xe.a,{size:"small"})):n.createElement("span",{style:{marginLeft:10,marginRight:10}},"Not Found.."),showArrow:!1,style:this.props.style,onSearch:this.onSearchOntClass,onChange:this.onChangeOntClassValue},t))},t}(n.Component),st=Object(s.a)({})(it),ot={onCancel:function(){},onDiscard:function(e){},onSave:function(e){}},lt=function(e){function t(t){var r=e.call(this,t)||this;return r.state={dataType:"xsd:string"},r.getSType=Object(_.a)(function(e,t){return r.getSType_(e,t)}),r.getSType_=function(e,t){var r=e.getDataNodeSemanticType(t);return void 0===r?{ontClass:void 0,ontPredicate:void 0}:r},r.onDiscard=function(){r.props.onDiscard(r.props.variable.id)},r.onSave=function(){r.classIdSelector.current.validate()&&r.ontPredicateSelector.current.validate()&&r.props.onSave({ontClass:r.classIdSelector.current.getValue(),ontPredicate:r.ontPredicateSelector.current.getValue(),dataType:r.state.dataType,variableId:r.props.variable.id})},r.onDataTypeChange=function(e){r.setState({dataType:e})},r.classIdSelector=n.createRef(),r.ontPredicateSelector=n.createRef(),r}return i.c(t,e),t.prototype.render=function(){var e=this.getSType(this.props.semanticModel,this.props.variable.id),t=S.c.map(function(e){return n.createElement($.a.Option,{key:e},e)});return n.createElement(p.a,{className:"margin-top-8"},n.createElement(G.a,{layout:"inline"},n.createElement(st,{innerRef:this.classIdSelector,key:e.ontClass?e.ontClass.id:void 0,sm:this.props.semanticModel,classId:e.ontClass,style:{minWidth:200}}),n.createElement(at,{ref:this.ontPredicateSelector,style:{minWidth:200},value:e.ontPredicate,fieldName:"Predicate"}),n.createElement(G.a.Item,{label:"Type"},n.createElement($.a,{value:this.state.dataType,showSearch:!0,style:{minWidth:120},onChange:this.onDataTypeChange},t)),n.createElement(G.a.Item,null,this.props.semanticModel.hasNode(this.props.variable.id)?n.createElement(c.a,{className:"margin-right-8",type:"danger",onClick:this.onDiscard},"Dismiss"):null,n.createElement(c.a,{className:"margin-right-8",onClick:this.props.onCancel},"Cancel"),n.createElement(c.a,{type:"primary",onClick:this.onSave},"Save"))))},t.defaultProps=ot,t}(n.Component),ct=Object(s.a)({})(lt),ut=r(56),dt={style:{},formItemProps:{},forbiddenNodes:new Set,filterDataNode:!1},pt=function(e){function t(t){var r=e.call(this,t)||this;return r.validate=function(){if(void 0===r.state.nodeId.validateStatus){var e=i.a({value:r.state.nodeId.value},r.validateNotInForbiddenList(r.state.nodeId.value));return r.setState({nodeId:e}),"success"===e.validateStatus}return"success"===r.state.nodeId.validateStatus},r.getValue=function(){return r.state.nodeId.value},r.onChangeValue=function(e){r.setState({nodeId:i.a({value:e},r.validateNotInForbiddenList(e))})},r.validateNotInForbiddenList=function(e){return void 0===e||r.props.forbiddenNodes.has(e)?{validateStatus:"error",errorMsg:"Cannot select nodes in forbidden list"}:{validateStatus:"success",errorMsg:void 0}},r.state={nodeId:{value:t.value}},r}return i.c(t,e),t.prototype.render=function(){var e,t,r,a,s=[];if(this.props.filterDataNode)try{for(var o=i.g(this.props.sm.iterClassNodes()),l=o.next();!l.done;l=o.next()){var c=l.value;s.push(n.createElement($.a.Option,{key:c.id},c.id))}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}else try{for(var u=i.g(this.props.sm.iterNodes()),d=u.next();!d.done;d=u.next()){c=d.value;s.push(n.createElement($.a.Option,{key:c.id},c.id))}}catch(h){r={error:h}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}return n.createElement(G.a.Item,i.a({label:this.props.fieldName},this.props.formItemProps),n.createElement($.a,{value:this.state.nodeId.value,showSearch:!0,style:this.props.style,onChange:this.onChangeValue},s))},t.defaultProps=dt,t}(n.Component),ht=function(e){function t(t){var r=e.call(this,t)||this;return r.onCreateEdge=function(){if(r.hasData()){var e=i.e(r.getSourceAndTarget(),2),t=e[0],n=e[1];r.props.dispatch(Object(q.m)(t,r.getPredicate(),n))}},r.onUpdateEdge=function(){if(r.hasData()){var e=i.e(r.getSourceAndTarget(),2),t=e[0],n=e[1];r.props.dispatch(Object(q.p)(r.props.edgeId,t,r.getPredicate(),n))}},r.onRemoveEdge=function(){r.props.dispatch(Object(q.n)(r.props.edgeId))},r.hasData=function(){return void 0!==r.getPredicate()&&void 0!==r.getOtherNodeId()},r.nodeSelector=n.createRef(),r.predicateSelector=n.createRef(),r}return i.c(t,e),t.prototype.render=function(){var e,t=this.props.sm.getNodeById(this.props.currentNodeId);return e=void 0===this.props.otherNodeId?n.createElement(c.a,{className:"margin-top-4",onClick:this.onCreateEdge},"Add"):n.createElement(n.Fragment,null,n.createElement(c.a,{className:"margin-top-4 margin-right-8",type:"danger",onClick:this.onRemoveEdge},"Remove"),n.createElement(c.a,{className:"margin-top-4",onClick:this.onUpdateEdge},"Update")),n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:9},n.createElement(pt,{ref:this.nodeSelector,sm:this.props.sm,fieldName:"",style:{width:"100%"},forbiddenNodes:new Set([t.id]),filterDataNode:!0,value:this.props.otherNodeId})),n.createElement(d.a,{span:9},n.createElement(at,{key:"new",fieldName:"",ref:this.predicateSelector,style:{width:"100%"},value:this.props.predicate})),n.createElement(d.a,{span:6},e))},t.prototype.getPredicate=function(){if(this.predicateSelector.current)return this.predicateSelector.current.getValue()},t.prototype.getOtherNodeId=function(){if(this.nodeSelector.current)return this.nodeSelector.current.getValue()},t.prototype.getSourceAndTarget=function(){var e,t,r=this.props.sm.getNodeById(this.getOtherNodeId()),n=this.props.sm.getNodeById(this.props.currentNodeId);return this.props.isIncomingEdge?(e=r.classId,t=n.classId):(e=n.classId,t=r.isClassNode()?r.classId:r.id),[e,t]},t}(n.Component),ft={labelCol:{span:6},wrapperCol:{span:18}},gt=function(e){function t(t){var r=e.call(this,t)||this;return r.onChangeMenu=function(e){r.setState({activeMenu:e.key})},r.onCancel=function(e){r.props.onHide()},r.onDiscard=function(e){r.props.onHide(),r.props.dispatch(Object(q.o)(r.props.nodeId))},r.ontClassSelector=n.createRef(),r.state={activeMenu:"OntClass"},r}return i.c(t,e),t.prototype.render=function(){var e,t;if(void 0===this.props.nodeId)return null;var r=this.props.sm.getNodeById(this.props.nodeId);if(!r.isClassNode())throw new Se.a("EditNodeModal component can only use to edit class node");var a=null;if("OntClass"===this.state.activeMenu)a=n.createElement(nt,{ref:this.ontClassSelector,key:this.props.nodeId,style:{width:"100%"},fieldName:"",value:this.props.sm.getNodeById(this.props.nodeId).classId.shortURI,formItemProps:ft});else{var s="IncomingEdge"===this.state.activeMenu,o=s?this.props.sm.iterIncomingEdges(r.id):this.props.sm.iterOutgoingEdges(r.id);(a=[]).push(n.createElement(ht,{key:"new",dispatch:this.props.dispatch,isIncomingEdge:s,sm:this.props.sm,currentNodeId:r.id}));try{for(var l=i.g(o),p=l.next();!p.done;p=l.next()){var h=p.value;a.push(n.createElement(ht,{key:h.id,edgeId:h.id,dispatch:this.props.dispatch,isIncomingEdge:s,sm:this.props.sm,currentNodeId:r.id,otherNodeId:s?h.sourceId:h.targetId,predicate:h.predicate}))}}catch(f){e={error:f}}finally{try{p&&!p.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}}return n.createElement(V.a,{title:"Edit Node",visible:this.props.visible,onCancel:this.onCancel,width:"80%",footer:[n.createElement(c.a,{type:"danger",key:"discard",onClick:this.onDiscard},"Remove"),n.createElement(c.a,{key:"back",onClick:this.onCancel},"Close")]},n.createElement(u.a,{gutter:8},n.createElement(d.a,{span:6},n.createElement(Ve.b,{mode:"inline",onSelect:this.onChangeMenu,defaultSelectedKeys:["OntClass"]},n.createElement(Ve.b.Item,{key:"OntClass"},"Ontology Class"),n.createElement(Ve.b.Item,{key:"IncomingEdge"},"Incoming Edges"),n.createElement(Ve.b.Item,{key:"OutgoingEdge"},"Outgoing Edges"))),n.createElement(d.a,{span:18},a)))},t}(n.Component),mt=Object(l.b)()(Object(s.a)({})(gt)),vt={labelCol:{span:6},wrapperCol:{span:18}},yt=function(e){function t(t){var r=e.call(this,t)||this;return r.onSave=function(e){r.ontPredicateSelector.current&&r.ontPredicateSelector.current.validate()&&(r.props.onHide(),void 0!==r.props.edgeId?r.props.dispatch(Object(q.p)(r.props.edgeId,r.source,r.getEditingPredicate(),r.target)):r.props.dispatch(Object(q.m)(r.source,r.getEditingPredicate(),r.target)))},r.onCancel=function(e){r.props.onHide()},r.onDiscard=function(e){r.props.onHide(),r.props.dispatch(Object(q.n)(r.props.edgeId))},r.getEditingPredicate=function(){if(r.ontPredicateSelector.current)return r.ontPredicateSelector.current.getValue()},r.ontPredicateSelector=n.createRef(),r.state={},r}return i.c(t,e),Object.defineProperty(t.prototype,"source",{get:function(){return this.props.sm.getNodeById(void 0!==this.props.edgeId?this.props.sm.getEdgeById(this.props.edgeId).sourceId:this.props.sourceId).classId},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this.props.sm.getNodeById(void 0!==this.props.edgeId?this.props.sm.getEdgeById(this.props.edgeId).targetId:this.props.targetId).classId},enumerable:!0,configurable:!0}),t.prototype.render=function(){var e,t,r;if(void 0===this.props.edgeId){if(void 0===this.props.sourceId)return null;t=void 0,e=this.props.sourceId,r=this.props.targetId}else{var a=this.props.sm.getEdgeById(this.props.edgeId);t=a.predicate,e=a.sourceId,r=a.targetId}var s=[];return void 0!==this.props.edgeId&&s.push(n.createElement(c.a,{type:"danger",key:"discard",onClick:this.onDiscard},"Remove")),s.push.apply(s,i.f([n.createElement(c.a,{key:"back",onClick:this.onCancel},"Cancel"),n.createElement(c.a,{type:"primary",key:"save",onClick:this.onSave},"Save")])),n.createElement(V.a,{title:"Edit Edge",visible:this.props.visible,onOk:this.onSave,onCancel:this.onCancel,width:"60%",footer:s},n.createElement(G.a,null,n.createElement(G.a.Item,i.a({label:"Source"},vt),e),n.createElement(G.a.Item,i.a({label:"Target"},vt),r),n.createElement(at,{ref:this.ontPredicateSelector,style:{width:"100%"},value:t,fieldName:"Predicate",formItemProps:vt})))},t}(n.Component),bt=Object(l.b)()(Object(s.a)({})(yt)),Et=[{selector:"node[label]",style:{label:"data(label)","text-halign":"center","text-valign":"center",width:"label",height:"label"}},{selector:'node[type="datanode"]',style:{backgroundColor:"#FED530",shape:"rectangle",padding:"10px"}},{selector:'node[type="classnode"]',style:{backgroundColor:"#D3D3D3",padding:"10px"}},{selector:"edge[label]",style:{width:2,label:"data(label)","text-background-color":"#FFFFFF","text-background-opacity":1,"curve-style":"bezier","control-point-step-size":75,"line-color":"#A32B2E","target-arrow-color":"#A32B2E","target-arrow-shape":"triangle"}}],wt={name:"breadthfirst",fit:!0,spacingFactor:.7,directed:!0},It=function(e){function t(t){var r=e.call(this,t)||this;return r.state={editingVariableId:void 0,upsertEdgeForm:{isVisible:!1},showEditNodeForm:void 0},r.getHasSTypesVariableIds=Object(_.a)(function(e){return r.getHasSTypesVariableIds_(e)}),r.canDrawEdgeBetweenNodes=function(e,t){return e!==t&&r.props.semanticModel.hasNode(e)&&r.props.semanticModel.hasNode(t)&&r.props.semanticModel.getNodeById(e).isClassNode()&&r.props.semanticModel.getNodeById(t).isClassNode()},r.onDrawNewEdgeComplete=function(e,t){r.setState({upsertEdgeForm:{edgeId:void 0,sourceId:e,targetId:t,isVisible:!0}})},r.onGraphNodeRightClick=function(e){r.props.semanticModel.getNodeById(e).isClassNode()?r.setState({showEditNodeForm:{nodeId:e}}):r.setState({editingVariableId:e})},r.onGraphEdgeClick=function(e){r.setState({upsertEdgeForm:i.a({},r.state.upsertEdgeForm,{edgeId:e,isVisible:!0})})},r.hideEditNodeForm=function(){r.setState({showEditNodeForm:void 0})},r.hideEditEdgeForm=function(){r.setState({upsertEdgeForm:{edgeId:void 0,sourceId:void 0,targetId:void 0,isVisible:!1}})},r.onVariableClick=function(e){r.setState({editingVariableId:e})},r.onSaveSTypeForm=function(e){r.props.dispatch(Object(q.l)(S.g.datanode(e.variableId,e.dataType))),r.props.dispatch(Object(q.m)(e.ontClass,e.ontPredicate,e.variableId)),r.setState({editingVariableId:void 0})},r.onCancelSTypeForm=function(){r.setState({editingVariableId:void 0})},r.onDiscardSTypeForm=function(e){r.setState({editingVariableId:void 0}),r.props.dispatch(Object(ut.d)(e))},r.getHasSTypesVariableIds_=function(e){var t,r,n=new Set;try{for(var a=i.g(e.iterDataNodes()),s=a.next();!s.done;s=a.next()){var o=s.value;n.add(o.id)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return n},r}return i.c(t,e),t.prototype.render=function(){var e,t,r,a,s=[],o=[];try{for(var l=i.g(this.props.semanticModel.iterNodes()),c=l.next();!c.done;c=l.next()){var u=c.value;s.push({id:u.id,label:u.id,type:u.type})}}catch(m){e={error:m}}finally{try{c&&!c.done&&(t=l.return)&&t.call(l)}finally{if(e)throw e.error}}try{for(var d=i.g(this.props.semanticModel.iterEdges()),p=d.next();!p.done;p=d.next()){var h=p.value;o.push({id:h.id,source:h.sourceId,label:h.predicate,target:h.targetId})}}catch(v){r={error:v}}finally{try{p&&!p.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}var f=null;if(void 0!==this.state.editingVariableId){var g=this.props.variables[this.state.editingVariableId];f=n.createElement(ct,{key:g.id,variable:g,semanticModel:this.props.semanticModel,onSave:this.onSaveSTypeForm,onCancel:this.onCancelSTypeForm,onDiscard:this.onDiscardSTypeForm})}return n.createElement(n.Fragment,null,n.createElement(te,{variables:x.values(this.props.variables),onVariableClick:this.onVariableClick,selectedVariableId:this.state.editingVariableId,highlightVariableIds:this.getHasSTypesVariableIds(this.props.semanticModel)}),f,n.createElement(Ie,{nodes:s,edges:o,title:"Semantic Model",styles:Et,layout:wt,enableEdgeDrawingCreation:!0,onNodeRightClick:this.onGraphNodeRightClick,onEdgeClick:this.onGraphEdgeClick,canDrawEdgeBetweenNodes:this.canDrawEdgeBetweenNodes,onDrawNewEdgeComplete:this.onDrawNewEdgeComplete}),n.createElement(mt,{sm:this.props.semanticModel,nodeId:void 0===this.state.showEditNodeForm?void 0:this.state.showEditNodeForm.nodeId,visible:void 0!==this.state.showEditNodeForm,onHide:this.hideEditNodeForm}),n.createElement(bt,{sm:this.props.semanticModel,edgeId:this.state.upsertEdgeForm.edgeId,sourceId:this.state.upsertEdgeForm.sourceId,targetId:this.state.upsertEdgeForm.targetId,visible:this.state.upsertEdgeForm.isVisible,onHide:this.hideEditEdgeForm}))},t}(n.Component);var St=Object(l.b)(function(e){return{variables:e.variables,semanticModel:e.semanticModel}})(Object(s.a)({})(It)),xt=r(181),Ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={errorMessage:""},t.onLogin=function(e){e.preventDefault(),t.props.form.validateFields(function(e,r){e||t.props.dispatch(Object(q.c)(r.email,r.password)).then(function(){t.setState({errorMessage:""})}).catch(function(){t.setState({errorMessage:"Invalid email or password"})})})},t}return i.c(t,e),t.prototype.render=function(){var e=this.props.form.getFieldDecorator;return n.createElement(u.a,{gutter:8,className:this.props.classes.loginForm},n.createElement(d.a,{span:8,offset:8},this.state.errorMessage.length>0&&n.createElement(Fe.a,{message:this.state.errorMessage,type:"error",banner:!0,closable:!0}),n.createElement(G.a,{onSubmit:this.onLogin,className:"login-form","data-testid":"user-login-form"},n.createElement(G.a.Item,null,e("email",{rules:[{required:!0,message:"Please input your Email!"}]})(n.createElement(J.a,{prefix:n.createElement(g.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email","data-testid":"user-login-form-email"}))),n.createElement(G.a.Item,null,e("password",{rules:[{required:!0,message:"Please input your Password!"}]})(n.createElement(J.a,{prefix:n.createElement(g.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password","data-testid":"user-login-form-password"}))),n.createElement(G.a.Item,null,e("remember",{valuePropName:"checked",initialValue:!0})(n.createElement(xt.a,null,"Remember me")),n.createElement(c.a,{type:"primary",htmlType:"submit",className:this.props.classes.loginFormBtn,"data-testid":"user-login-form-login-button"},"Log in")))))},t}(n.Component);var Dt=G.a.create({})(Object(l.b)(function(e){return{app:e.app}})(Object(s.a)({loginForm:{marginTop:50,"& .login-form":{marginTop:10}},loginFormBtn:{width:"100%"}})(Ct))),kt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={activeMenu:"dashboard",loaded:!1},t.onChangeMenu=function(e){t.setState({activeMenu:e.key})},t}return i.c(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.app.attempt2ReLoggedIn().then(function(t){t.isLoggedIn()?e.props.dispatch(q.d(t)).then(function(){e.setState({loaded:!0})}).catch(function(e){window.console.error(e),Oe.a.error({message:"Error while loading application",description:"Please try again later"})}):e.setState({loaded:!0})})},t.prototype.render=function(){if(!this.state.loaded)return n.createElement("div",{style:{textAlign:"center",marginTop:30}},n.createElement("p",null,"Loading"),n.createElement(g.a,{type:"loading",style:{fontSize:"3em"}}));if(!this.props.app.isLoggedIn())return n.createElement(Dt,null);var e;switch(this.props.app.synchStatus){case W.b.synched:e=n.createElement(g.a,{type:"check-circle",theme:"twoTone",twoToneColor:"#52c41a"});break;case W.b.synching:e=n.createElement(g.a,{type:"sync",spin:!0});break;case W.b.error:e=n.createElement(g.a,{type:"warning",theme:"twoTone",twoToneColor:"#f5222d"});break;default:throw new Error("Invalid sync status "+this.props.app.synchStatus)}e=n.createElement("span",null,e,"Dashboard");var t=null;switch(this.state.activeMenu){case"dashboard":t=n.createElement(Qe,{app:this.props.app});break;case"resource":t=n.createElement(H,null);break;case"layout":case"layout":t=n.createElement(ne,null);break;case"mapping":t=n.createElement(Re,null);break;case"semantic_model":t=n.createElement(St,null)}return n.createElement(Ne.a,{className:"App"},n.createElement(Ne.a.Header,{style:{position:"fixed",zIndex:1,width:"100%",height:55}},n.createElement("h1",{className:"logo"},"D-Repr"),n.createElement(Ve.b,{theme:"dark",mode:"horizontal",onSelect:this.onChangeMenu,selectedKeys:[this.state.activeMenu],style:{lineHeight:"55px"}},n.createElement(Ve.b.Item,{key:"dashboard"},e),n.createElement(Ve.b.Item,{key:"resource",disabled:!this.props.hasActiveDataset},n.createElement(g.a,{type:"database",theme:"filled"}),"Resources"),n.createElement(Ve.b.Item,{key:"layout",disabled:!this.props.hasResources},n.createElement("span",null,n.createElement(g.a,{type:"layout",theme:"filled"}),"Attributes")),n.createElement(Ve.b.Item,{key:"mapping",disabled:!this.props.hasResources},n.createElement("span",null,n.createElement(g.a,{type:"api",theme:"filled"}),"Alignments")),n.createElement(Ve.b.Item,{key:"semantic_model",disabled:!this.props.hasResources},n.createElement("span",null,n.createElement(g.a,{type:"deployment-unit"}),"Semantic Model")),n.createElement(Ve.b.SubMenu,{title:n.createElement(Te.a,{style:{backgroundColor:"#f56a00",verticalAlign:"middle",marginTop:-3},size:"default"},"T"),key:"user",style:{float:"right"}},n.createElement(Ve.b.Item,null,n.createElement("span",null,n.createElement(g.a,{type:"setting"}),"Settings")),n.createElement(Ve.b.Item,null,n.createElement("span",null,n.createElement(g.a,{type:"logout"}),"Logout"))))),n.createElement(Ne.a.Content,{style:{marginTop:55,padding:10,height:"100%"}},t))},t}(n.Component);var Rt=Object(l.b)(function(e){return{app:e.app,hasActiveDataset:null!==e.datasets.activeDataset,hasResources:x.size(e.resources)>0}})(kt),Ot=(r(585),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function Nt(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var Vt=r(71),Tt=r(11);function Ft(e,t,r,n){var a,s;if(e.hasNode(t.id)||e.addNode(S.g.classnode(t)),n instanceof S.b&&!e.hasNode(n.id)&&e.addNode(S.g.classnode(n)),n instanceof S.b)e.addEdge(t.id,r,n.id);else{try{for(var o=i.g(e.iterIncomingEdges(n)),l=o.next();!l.done;l=o.next()){var c=l.value;e.upwardCascadeRemoveEdge(c.id)}}catch(u){a={error:u}}finally{try{l&&!l.done&&(s=o.return)&&s.call(o)}finally{if(a)throw a.error}}e.addEdge(t.id,r,n)}}var Pt=Object(Vt.c)({app:function(e,t){switch(void 0===e&&(e=W.d),t.type){case Tt.c:return t.app;case Tt.d:var r=e.cloneRef();return r.synchStatus=t.syncStatus,r;default:return e}},uiConf:function(e,t){switch(void 0===e&&(e=W.i),t.type){case Tt.u:return e.setDisplayMax1Resource(t.value);default:return e}},datasets:function(e,t){switch(void 0===e&&(e=W.e),t.type){case Tt.g:return{datasets:t.datasets,activeDataset:e.activeDataset};case Tt.f:return{datasets:e.datasets,activeDataset:null};case Tt.e:return{datasets:i.f(e.datasets,[t.dataset]),activeDataset:e.activeDataset};case Tt.i:return{datasets:e.datasets,activeDataset:t.datasetName};case Tt.h:return{datasets:x.filter(e.datasets,function(e){return e.name!==t.datasetName}),activeDataset:e.activeDataset===t.datasetName?null:e.activeDataset};default:return e}},resources:function(e,t){var r,n;switch(void 0===e&&(e=W.g),t.type){case Tt.i:return x.keyBy(t.resources,function(e){return e.resource.resourceId});case Tt.f:return W.g;case Tt.o:return i.a({},e,((r={})[t.resourceID]=t.resource,r));case Tt.n:return e[t.resourceID].data.pod=t.pod,i.a({},e,((n={})[t.resourceID]=e[t.resourceID],n));case Tt.m:var a=i.a({},e);return delete a[t.resourceId],a;default:return e}},variables:function(e,t){switch(void 0===e&&(e=W.j),t.type){case Tt.i:return x.keyBy(t.variables,function(e){return e.id});case Tt.f:return W.j;case Tt.w:var r=i.a({},e);return null!==t.previousVariableId&&delete r[t.previousVariableId],r[t.variable.id]=t.variable,r;case Tt.v:return delete(r=i.a({},e))[t.variableId],r;default:return e}},ontologies:function(e,t){var r;switch(void 0===e&&(e=W.f),t.type){case Tt.k:return x.keyBy(t.ontologies,function(e){return e.prefix});case Tt.j:return i.a({},e,((r={})[t.prefix]=new S.h(t.prefix,t.namespace),r));case Tt.l:var n=i.a({},e);return delete n[t.prefix],n;default:return e}},semanticModel:function(e,t){switch(void 0===e&&(e=W.h),t.type){case Tt.i:return t.semanticModel;case Tt.f:return W.h;case Tt.p:return e.hasNode(t.dnode.id)?e:(e.addNode(t.dnode),e.cloneRef());case Tt.q:return Ft(e,t.sourceId,t.predicate,t.targetId),e.cloneRef();case Tt.s:return e.cascadeRemoveNode(t.nodeId),e.cloneRef();case Tt.r:return e.upwardCascadeRemoveEdge(t.edgeId),e.cloneRef();case Tt.t:var r=e.getEdgeById(t.edgeId);return r.sourceId===t.sourceId.id&&r.targetId===(t.targetId instanceof S.b?t.targetId.id:t.targetId)?r.predicate=t.predicate:(Ft(e,t.sourceId,t.predicate,t.targetId),e.upwardCascadeRemoveEdge(t.edgeId)),e.cloneRef();default:return e}},alignments:function(e,t){var r,n;switch(void 0===e&&(e=W.c),t.type){case Tt.i:return t.alignments;case Tt.f:return W.c;case Tt.b:var a=e.filter(function(e){return!e.isEqual(t.mapping)});return a.push(t.mapping),a;case Tt.w:if(null!==t.previousVariableId){var s=[];try{for(var o=i.g(e),l=o.next();!l.done;l=o.next()){var c=l.value;c.source===t.previousVariableId&&(c.source=t.variable.id),c.target===t.previousVariableId&&(c.target=t.variable.id),s.push(c)}}catch(u){r={error:u}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}return e;case Tt.v:return e.filter(function(e){return e.source!==t.variableId&&e.target!==t.variableId});case Tt.a:return e.filter(function(e){return!e.isEqual(t.mapping)});default:return e}}}),jt=r(287),Mt=r(288),At=r.n(Mt),_t=Object(Vt.d)(Pt,Object(Vt.a)(jt.a,At.a,function(e){return function(t){return function(r){var n=t(r);switch(r.type){case Tt.w:var a=e.getState();t(Object(q.e)(W.b.synching)),a.app.post("/datasets/"+a.datasets.activeDataset+"/variables",{prev_id:r.previousVariableId,id:r.variable.id,sorted:r.variable.sorted,value_type:r.variable.type,unique:r.variable.unique,missing_values:r.variable.missingValues,location:{resource_id:r.variable.location.resourceId,slices:x.map(r.variable.location.slices,function(e){return e.serialize()})}}).then(function(e){t(Object(q.e)(W.b.synched))}).catch(function(){t(Object(q.e)(W.b.error))});break;case Tt.v:a=e.getState(),t(Object(q.e)(W.b.synching)),a.app.delete("/datasets/"+a.datasets.activeDataset+"/variables/"+r.variableId).then(function(e){t(Object(q.e)(W.b.synched))}).catch(function(){t(Object(q.e)(W.b.error))});break;case Tt.p:break;case Tt.q:case Tt.s:case Tt.r:case Tt.t:a=e.getState(),t(Object(q.e)(W.b.synching)),a.app.post("/datasets/"+a.datasets.activeDataset+"/semantic_model",a.semanticModel.serialize(a.ontologies)).then(function(e){t(Object(q.e)(W.b.synched))}).catch(function(){t(Object(q.e)(W.b.error))});break;case Tt.a:case Tt.b:a=e.getState(),t(Object(q.e)(W.b.synching)),a.app.post("/datasets/"+a.datasets.activeDataset+"/alignments",x.map(a.alignments,function(e){return e.serialize()})).then(function(e){t(Object(q.e)(W.b.synched))}).catch(function(){t(Object(q.e)(W.b.error))})}return n}}}));a.render(n.createElement(l.a,{store:_t},n.createElement(Rt,null)),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location.toString()).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="/service-worker.js";Ot?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Nt(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):Nt(e)})}}()},59:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(2),a=function(e){function t(t){var r=e.call(this,"Congrat! You found a bug! "+t)||this;return r.name="Bug",r}return n.c(t,e),t}(Error)},69:function(e,t,r){"use strict";r.d(t,"b",function(){return s}),r.d(t,"a",function(){return o});var n=r(2),a=r(11),i=(r(14),r(9),r(35),r(598));function s(e,t){var r=this;return function(i,s){return n.b(r,void 0,void 0,function(){return n.d(this,function(r){return[2,s().app.delete("/ontologies/"+t).then(function(){return i({type:a.l,prefix:e,namespace:t})})]})})}}function o(e,t,r){var s=this;return function(o,l){return n.b(s,void 0,void 0,function(){var s;return n.d(this,function(n){return(s=new FormData).set("ontology_file",e),s.set("prefix",t),s.set("namespace",r),[2,l().app.post("/ontologies",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){return e.data.n_classes+e.data.n_predicates===0?(i.a.warning({message:"ontology",description:"The ontology is imported, but 0 class and predicate was added"}),null):(i.a.info({message:"Import ontology success",description:e.data.n_classes+" classes added and "+e.data.n_predicates+" predicates added"}),o({type:a.j,prefix:t,namespace:r}))})]})})}}},83:function(e,t,r){"use strict";r.d(t,"d",function(){return s}),r.d(t,"c",function(){return l}),r.d(t,"a",function(){return c}),r.d(t,"b",function(){return u}),r.d(t,"e",function(){return d});var n=r(2),a=r(22),i=r(9),s=-1/0,o=/^(?:(\d+|(?:\${[^}]+}))?\.\.(\d+|(?:\${[^}]+}))?(?:;(\d+|(?:\${[^}]+})))?)|(\d+|(?:\${[^}]+}))$/,l=function(){function e(e,t,r){void 0===r&&(r=1),this.start=e,this.end=t,this.step=r}return e.default=function(){return new e(s,s,1)},e.prototype.isSelectOne=function(){return(this.end-this.start)/this.step===1},e.prototype.isSelected=function(e){return e>=this.start&&e<this.end&&Number.isInteger((e-this.start)/this.step)},e.prototype.isRangeOverlapped=function(e,t){return t>this.start&&this.end>e},e.prototype.clone=function(){return new e(this.start,this.end,this.step)},e.prototype.isUninitialized=function(){return this.start===s&&this.end===s},e.prototype.toString=function(){if(this.isUninitialized())return" ";if(this.end===this.start+this.step)return""+this.start;var e=1===this.step?"":";"+this.step;return this.end===1/0?this.start+".."+e:this.start+".."+this.end+e},e.prototype.serialize=function(){return{type:"range",start:this.start,end:this.end,step:this.step}},e}(),c=function(){function e(e){this.index=e}return e.default=function(){return new e(s)},e.prototype.isSelectOne=function(){return!0},e.prototype.isSelected=function(e){return this.index!==s&&this.index===e},e.prototype.clone=function(){return new e(this.index)},e.prototype.isUninitialized=function(){return this.index===s},e.prototype.toString=function(){return this.isUninitialized()?" ":""+this.index},e.prototype.serialize=function(){return{type:"index",idx:this.index}},e}(),u=function(){function e(e,t){this.resourceId=e,this.slices=t}return e.fromSerializedSlices=function(t,r){return new e(t,r.map(function(e){switch(e.type){case"range":return new l(e.start,null===e.end?1/0:e.end,e.step);case"index":return new c(e.idx);default:throw new Error("Invalid slice type: "+e.type)}}))},e.fromString=function(t,r){var a,i,s=[];try{for(var u=n.g(r.split(":")),d=u.next();!d.done;d=u.next()){var p=d.value,h=o.exec(p);null!==h?void 0!==h[4]?s.push(new c(parseInt(h[4],10))):s.push(new l(parseInt(h[1]||"0",10),h[2]?parseInt(h[2],10):1/0,parseInt(h[3]||"1",10))):s.push(new c(p))}}catch(f){a={error:f}}finally{try{d&&!d.done&&(i=u.return)&&i.call(u)}finally{if(a)throw a.error}}return new e(t,s)},e.prototype.toString=function(e){var t,r,a=[];try{for(var i=n.g(this.slices),s=i.next();!s.done;s=i.next()){var o=s.value;a.push(o.toString())}}catch(l){t={error:l}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return e?a.join(":"):this.resourceId+"@"+a.join(":")},e.prototype.validate=function(e){return function e(t,r,s){var o,c;if(t===r.length)return!1;var u=r[t];if(u instanceof l){if(s instanceof a.RangeDimension){if(!(s.range[0]<=u.start&&(u.end===1/0||s.range[s.range.length-1]>=u.end)))return!1;for(var d=i.sortedLastIndex(s.range,u.start)-1,p=[],h=d;h<s.range.length-1&&(p.push(s.values[h]),!(s.range[h+1]>=u.end));h++);try{for(var f=n.g(p),g=f.next();!g.done;g=f.next()){var m=g.value;if(null===m)return t===r.length-1;if(void 0===m)return!1;if(!e(t+1,r,m))return!1}}catch(y){o={error:y}}finally{try{g&&!g.done&&(c=f.return)&&c.call(f)}finally{if(o)throw o.error}}return!0}return!1}if(s instanceof a.RangeDimension&&"number"!==typeof u.index)return!1;var v=s.get(u.index);return null===v?t===r.length-1:void 0!==v&&e(t+1,r,v)}(0,this.slices,e)},e.prototype.clone=function(){return new e(this.resourceId,this.slices.map(function(e){return e.clone()}))},e}();var d=function(){function e(e,t,r,n,a,i){this.id=e,this.location=i,this.sorted=t,this.type=r,this.unique=n,this.missingValues=a}return e.default=function(t,r){return new e(t,"none","unspecified",!1,[],r)},e.prototype.clone=function(){return new e(this.id,this.sorted,this.type,this.unique,this.missingValues,this.location.clone())},e}()},98:function(e,t,r){"use strict";r.d(t,"d",function(){return i}),r.d(t,"c",function(){return s}),r.d(t,"a",function(){return o}),r.d(t,"b",function(){return l});var n=r(2),a=r(22),i=function(){function e(){this.$hasAllIndices=!1,this.$hasAllUpperIndices=!1}return e.fromSlices=function(e,t,r){if(!t.isValidSlice(e))throw new Error("The slice doesn't match with the dimension");return c(e,t,r,[])},Object.defineProperty(e.prototype,"hasAllIndices",{get:function(){return this.$hasAllIndices},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasAllUpperIndices",{get:function(){return this.$hasAllUpperIndices},enumerable:!0,configurable:!0}),e.prototype.setHasAllIndices=function(){this.$hasAllIndices=!0,this.$hasAllUpperIndices=!0},e.prototype.setHasAllUpperIndices=function(){this.$hasAllUpperIndices=!0},e.prototype.addData=function(e,t,r){if(!t.isValidSlice(e,!0))throw new Error("The slice doesn't match with the dimension");return function e(t,r,i,u,d){var p,h,f,g;if(null===r)return new a.UnitOfData(d.slice(),u);if(t instanceof s){if(!(r instanceof a.IndexDataSlice))throw new Error("You can only set data for HashMapPortionOfData when using IndexDataSlice");var m=d.length;d.push("");try{for(var v=n.g(Object.keys(r.index2slice)),y=v.next();!y.done;y=v.next()){var b=y.value;d[m]=b,b in t.hashMap?e(t.hashMap[b],r.index2slice[b],i.get(b),u[b],d):t.hashMap[b]=c(r.index2slice[b],i.get(b),u[b],d)}}catch(M){p={error:M}}finally{try{y&&!y.done&&(h=v.return)&&h.call(v)}finally{if(p)throw p.error}}return d.pop(),t.hasAllIndices||new Set(Object.keys(t.hashMap))===new Set(Object.keys(i.index2val))&&t.setHasAllIndices(),t}if(!(r instanceof a.ContinuousRangeDataSlice))throw new Error("You can only set data for ArrayPortionOfData when using ContinuousRangeDataSlice");if(t instanceof l){var E=-1,w=-1;try{for(var I=n.g(t.arrays.entries()),S=I.next();!S.done;S=I.next()){var x=n.e(S.value,2),m=x[0],C=x[1];F=C.start,P=C.end,j=r.start,r.end>=F&&P>=j&&(-1===E?(E=m,w=m+1):w++)}}catch(A){f={error:A}}finally{try{S&&!S.done&&(g=I.return)&&g.call(I)}finally{if(f)throw f.error}}if(E===w){if(u.length>0){var D=c(r,i,u,d);if(!(D instanceof l))throw new Error("[BUG] Congrat! You found a bug, darray must always be DiscontinuousArrayPOD");t.arrays[0].start>D.arrays[0].start?t.arrays.unshift(D.arrays[0]):t.arrays.push(D.arrays[0])}else if(r.start===t.arrays[t.arrays.length-1].end){if(1===t.arrays.length&&i.range[0]===t.arrays[0].start)return t.arrays[0].setHasAllIndices(),t.arrays[0];t.setHasAllUpperIndices()}}else{var k=d.length,D=new o(Math.min(r.start,t.arrays[E].start));d.push(-1);for(var R=r.start;R<t.arrays[E].start;R++){d[k]=R;var O=c(r.getValue(R),i.get(R),u[R-r.start],d);D.push(O)}for(var m=E;m<w;m++){for(var N=t.arrays[m],R=N.start;R<N.end;R++)if(R>=r.start&&R<r.end){d[k]=R;var O=e(N.get(R),r.getValue(R),i.get(R),u[R-r.start],d);D.push(O)}else D.push(N.get(R));if(m+1<w&&N.end<t.arrays[m+1].start)for(var R=N.end;R<t.arrays[m+1].start;R++){d[k]=R;var O=c(r.getValue(R),i.get(R),u[R-r.start],d);D.push(O)}}for(var R=t.arrays[w-1].end;R<r.start+u.length;R++){d[k]=R;var O=c(r.getValue(R),i.get(R),u[R-r.start],d);D.push(O)}d.pop();var V=t.arrays.slice(0,E);V.push(D),t.arrays=V.concat(t.arrays.slice(w))}if((r.start===r.end&&r.start===t.arrays[t.arrays.length-1].end||u.length>0&&r.end>r.start+u.length)&&!t.hasAllIndices){if(1===t.arrays.length&&i.range[0]===t.arrays[0].start)return t.arrays[0].setHasAllIndices(),t.arrays[0];t.setHasAllUpperIndices()}}else{var k=d.length;d.push(0);for(var R=r.start,T=r.start+u.length;R<T;R++){d[k]=R;var O=e(t.get(R),r.getValue(R),i.get(R),u[R-r.start],d);t.set(R,O)}d.pop()}return t;var F,P,j}(this,e,t,r,[])},e.prototype.getData=function(e){if(1===e.length)return this.get(e[0]);for(var t=this,r=0;r<e.length-1;r++)t=t.get(e[r]);return t.get(e[e.length-1])},e}(),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return n.c(t,e),t.prototype.portionSize=function(){return Object.keys(this.hashMap).length},t.prototype.mayHas=function(e){return e in this.hashMap||!this.hasAllIndices},t.prototype.get=function(e){return this.hashMap[e]},t.prototype.toJSON=function(){var e,t,r={};try{for(var a=n.g(Object.keys(this.hashMap)),s=a.next();!s.done;s=a.next()){var o=s.value,l=this.hashMap[o];r[o]=l instanceof i?l.toJSON():l.value}}catch(c){e={error:c}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r},t}(i),o=function(e){function t(t){var r=e.call(this)||this;return r.start=t,r.end=t,r.items=new Array,r}return n.c(t,e),t.prototype.mayHas=function(e){return this.start<=e&&e<this.end},t.prototype.portionSize=function(){return this.items.length},t.prototype.push=function(e){this.items.push(e),this.end++},t.prototype.get=function(e){return this.items[e-this.start]},t.prototype.set=function(e,t){this.items[e-this.start]=t},t.prototype.toJSON=function(){if(0!==this.start)throw new Error("[BUG] the start should always be 0 because it is not discontinuous");return this.items.map(function(e){return e instanceof i?e.toJSON():e.value})},t}(i),l=function(e){function t(t){var r=e.call(this)||this;return r.arrays=t,r}return n.c(t,e),t.prototype.mayHas=function(e){var t,r;try{for(var a=n.g(this.arrays),i=a.next();!i.done;i=a.next()){if(i.value.mayHas(e))return!0}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}return!this.hasAllIndices},t.prototype.get=function(e){var t,r;try{for(var a=n.g(this.arrays),i=a.next();!i.done;i=a.next()){var s=i.value;if(s.start<=e&&e<=s.end)return s.get(e)}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=a.return)&&r.call(a)}finally{if(t)throw t.error}}throw Error("Invalid index "+e)},t.prototype.portionSize=function(){return this.arrays.reduce(function(e,t){return e+t.portionSize()},0)},t.prototype.toJSON=function(){var e,t,r,a,s=[];try{for(var o=n.g(this.arrays),l=o.next();!l.done;l=o.next()){for(var c=l.value;s.length<c.start;)s.push(null);try{for(var u=n.g(c.items),d=u.next();!d.done;d=u.next()){var p=d.value;s.push(p instanceof i?p.toJSON():p.value)}}catch(h){r={error:h}}finally{try{d&&!d.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}}}catch(f){e={error:f}}finally{try{l&&!l.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return s},t}(i);function c(e,t,r,i){var u,d;if(null===e)return new a.UnitOfData(i.slice(),r);if(e instanceof a.ContinuousRangeDataSlice){var p=new o(e.start),h=i.length;i.push(0);for(var f=0;f<r.length&&f<e.end;f++)i[h]=e.start+f,p.push(c(e.getValue(i[h]),t.get(i[h]),r[f],i));return i.pop(),e.isSlicingAllIndices(t)?(p.setHasAllIndices(),p):new l([p])}var g=new s;h=i.length;i.push("");try{for(var m=n.g(Object.keys(e.index2slice)),v=m.next();!v.done;v=m.next()){f=v.value;i[h]=f,g.hashMap[f]=c(e.index2slice[f],t.get(f),r[f],i)}}catch(y){u={error:y}}finally{try{v&&!v.done&&(d=m.return)&&d.call(m)}finally{if(u)throw u.error}}return i.pop(),e.isSlicingAllIndices(t)&&g.setHasAllIndices(),g}}},[[290,2,1]]]);
//# sourceMappingURL=main.a04d4be9.chunk.js.map